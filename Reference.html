
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SNL Reference for Version 2.2 &#8212; EPICS Sequencer Version 2.2</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/naturefixed.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples of SNL Programs" href="Examples.html" />
    <link rel="prev" title="Escape to C Code" href="EscapeToC.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Examples.html" title="Examples of SNL Programs"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="EscapeToC.html" title="Escape to C Code"
             accesskey="P">previous</a> |</li>
    <span style="font-size:150%; font-weight:bold" ><a href="index.html">EPICS Sequencer Version 2.2</a></span>
          <li class="nav-item nav-item-1"><a href="Manual.html" accesskey="U">Users’ Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">SNL Reference for Version 2.2</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="snl-reference-for-version-2-2">
<h1>SNL Reference for Version 2.2<a class="headerlink" href="#snl-reference-for-version-2-2" title="Permalink to this headline">¶</a></h1>
<p>This chapter gives a detailed reference for the SNL syntax and semantics and
for the built-in functions of SNL in version 2.2. The <a class="reference external" href="http://www-csr.bessy.de/control/SoftDist/sequencer-2-1/Reference.html">documentation for
version 2.1</a> is and will remain available, too.</p>
<p>Formal syntax is given in <a class="reference external" href="http://en.wikipedia.org/wiki/Backus-Naur_Form">BNF</a>. Multiple rules for the same
<a class="reference external" href="http://en.wikipedia.org/wiki/Terminal_and_nonterminal_symbols#Nonterminal_symbols">nonterminal symbol</a> mean that any of the given rules may apply. <a class="reference external" href="http://en.wikipedia.org/wiki/Terminal_and_nonterminal_symbols#Terminal_symbols">Terminal
symbols</a> are enclosed in double quotes.</p>
<div class="section" id="lexical-syntax">
<h2>Lexical Syntax<a class="headerlink" href="#lexical-syntax" title="Permalink to this headline">¶</a></h2>
<p>The lexical syntax is not specified formally in this document, since it is
almost identical to that of C. There are only two exceptions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#embedded-c-code">Embedded C Code</a>, and</p></li>
<li><p>more reserved words.</p></li>
</ul>
<p>We use an informal notation with explanatory text in agle brackets standing
in for the formal definition.</p>
<div class="section" id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-comment">comment</strong> ::=  &quot;/*&quot; &lt;anything&gt; &quot;*/&quot;
<strong id="grammar-token--0">comment</strong> ::=  &quot;//&quot; &lt;anything until end of line&gt;
</pre>
<p>C-style comments may be placed anywhere in the program. They are
treated as white space. As in C, comments cannot be nested.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<p>C++ style comments are allowed, too.</p>
</div>
<div class="section" id="identifiers">
<h3>Identifiers<a class="headerlink" href="#identifiers" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-identifier">identifier</strong> ::=  &lt;same as in C&gt;
</pre>
<p>Identifiers follow the same rules as in C. They are used for variables
(including foreign variables and event flags), the program name,
states, state sets, and options.</p>
</div>
<div class="section" id="literals">
<h3>Literals<a class="headerlink" href="#literals" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-integer_literal"><span id="grammar-token-integer-literal"></span>integer_literal       </strong> ::=  &lt;same as in C&gt;
<strong id="grammar-token-floating_point_literal"><span id="grammar-token-floating-point-literal"></span>floating_point_literal</strong> ::=  &lt;same as in C&gt;
<strong id="grammar-token-string_literal"><span id="grammar-token-string-literal"></span>string_literal        </strong> ::=  &lt;same as in C&gt;
</pre>
<p>The lexical syntax of identifiers, as well as numeric and string
literals is exactly as in C, including automatic string
concatenation, character literals, and octal, decimal, and
hexadecimal integer literals.</p>
</div>
<div class="section" id="embedded-c-code">
<h3>Embedded C Code<a class="headerlink" href="#embedded-c-code" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-embedded_c_code"><span id="grammar-token-embedded-c-code"></span>embedded_c_code</strong> ::=  &quot;%{&quot; &lt;anything&gt; &quot;}%&quot;
<strong id="grammar-token--1">embedded_c_code</strong> ::=  &quot;%%&quot; &lt;anything&gt; &quot;\n&quot;
</pre>
<p>A sequence of characters enclosed between “%{” and “}%” is used
literally and without further parsing as if it were a complete
declaration or statement, depending on where it appears.</p>
<p>A sequence of characters enclosed between “%%” and the next line ending
is treated similarly, except that it is stripped of leading and
trailing whitespace and inserted in the output with the current
indentation.</p>
<p>Note that embedded C code fragments are <em>not</em> allowed to appear in
expressions.</p>
<p>See <a class="reference internal" href="EscapeToC.html#escape-to-c-code"><span class="std std-ref">Escape to C Code</span></a> for examples and rationale.</p>
<p>Embedded C code fragments are the cause for one of the two conflicts in the
grammar. The reason is that the parser cannot always decide whether such a
fragment is a declaration or a statement. (The other conflict is due to the
infamous “dangling else”.)</p>
</div>
<div class="section" id="line-markers">
<h3>Line Markers<a class="headerlink" href="#line-markers" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-line_marker"><span id="grammar-token-line-marker"></span>line_marker</strong> ::=  &quot;#&quot; line_number &quot;\n&quot;
<strong id="grammar-token--2">line_marker</strong> ::=  &quot;#&quot; line_number file_name &quot;\n&quot;
<strong id="grammar-token-line_number"><span id="grammar-token-line-number"></span>line_number</strong> ::=  &lt;non-empty sequence of decimals&gt;
<strong id="grammar-token-file_name"><span id="grammar-token-file-name"></span>file_name  </strong> ::=  &lt;like string_literal, without automatic string concatenation&gt;
</pre>
<p>Line markers are interpreted exactly as in C, i.e. they indicate
that the following symbols are really located in the given source file (if
any) at the given line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#grammar-token-line_number"><code class="xref any std std-token docutils literal notranslate"><span class="pre">line_number</span></code></a> may only contain decimal numbers, and
<a class="reference internal" href="#grammar-token-file_name"><code class="xref any std std-token docutils literal notranslate"><span class="pre">file_name</span></code></a> must be a single string (no automatic string
concatenation).</p>
</div>
<p>Line markers are typically generated by preprocessors, such as <a class="reference internal" href="Glossary.html#term-cpp"><code class="xref any std std-term docutils literal notranslate"><span class="pre">cpp</span></code></a>.</p>
</div>
</div>
<div class="section" id="program">
<h2>Program<a class="headerlink" href="#program" title="Permalink to this headline">¶</a></h2>
<pre>
<strong id="grammar-token-program">program</strong> ::=  &quot;program&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a> <a class="reference internal" href="#grammar-token--3"><code class="xref docutils literal notranslate"><span class="pre">program_param</span></code></a> <a class="reference internal" href="#grammar-token--4"><code class="xref docutils literal notranslate"><span class="pre">initial_defns</span></code></a> <a class="reference internal" href="#grammar-token--16"><code class="xref docutils literal notranslate"><span class="pre">entry</span></code></a> <a class="reference internal" href="#grammar-token--77"><code class="xref docutils literal notranslate"><span class="pre">state_sets</span></code></a> <a class="reference internal" href="#grammar-token--17"><code class="xref docutils literal notranslate"><span class="pre">exit</span></code></a> <a class="reference internal" href="#grammar-token--13"><code class="xref docutils literal notranslate"><span class="pre">final_defns</span></code></a>
</pre>
<p>This is the overall structure of an SNL program. After the keyword
“program” comes the name of the program, followed by an optional program
parameter, initial global definitions, an optional entry block, the state sets, an
optional exit block, and then again global definitions.</p>
<div class="section" id="program-name-and-parameters">
<h3>Program Name and Parameters<a class="headerlink" href="#program-name-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>The program name is an identifier. It is used as the name of the global
variable which contains or points to all the program data structures
(the address of this global variable is passed to the <code class="docutils literal notranslate"><span class="pre">seq</span></code> function when
creating the run-time sequencer). It is also used as the base for the state
set thread names unless overridden via the <em>name</em> parameter (see <a class="reference internal" href="Using.html#run-time-parameters"><span class="std std-ref">Program Parameters</span></a>).</p>
<pre>
<strong id="grammar-token-program_param"><span id="grammar-token-program-param"></span>program_param</strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token-string"><code class="xref docutils literal notranslate"><span class="pre">string</span></code></a> &quot;)&quot;
<strong id="grammar-token--3">program_param</strong> ::= 
</pre>
<p>The program name may be followed by an optional string enclosed in
parentheses. The string content must be a list of comma-separated
parameters in the same form as if specified on invocation (see
<a class="reference internal" href="Using.html#run-time-parameters"><span class="std std-ref">Program Parameters</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parameters specified on invocation override those specified in the
program.</p>
</div>
<pre>
<strong id="grammar-token-initial_defns"><span id="grammar-token-initial-defns"></span>initial_defns</strong> ::=  <a class="reference internal" href="#grammar-token--4"><code class="xref docutils literal notranslate"><span class="pre">initial_defns</span></code></a> <a class="reference internal" href="#grammar-token--12"><code class="xref docutils literal notranslate"><span class="pre">initial_defn</span></code></a>
<strong id="grammar-token--4">initial_defns</strong> ::= 
<strong id="grammar-token-initial_defn"><span id="grammar-token-initial-defn"></span>initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token--69"><code class="xref docutils literal notranslate"><span class="pre">assign</span></code></a>
<strong id="grammar-token--5">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token-monitor"><code class="xref docutils literal notranslate"><span class="pre">monitor</span></code></a>
<strong id="grammar-token--6">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token-sync"><code class="xref docutils literal notranslate"><span class="pre">sync</span></code></a>
<strong id="grammar-token--7">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token--74"><code class="xref docutils literal notranslate"><span class="pre">syncq</span></code></a>
<strong id="grammar-token--8">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token--31"><code class="xref docutils literal notranslate"><span class="pre">declaration</span></code></a>
<strong id="grammar-token--9">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token-option"><code class="xref docutils literal notranslate"><span class="pre">option</span></code></a>
<strong id="grammar-token--10">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token-funcdef"><code class="xref docutils literal notranslate"><span class="pre">funcdef</span></code></a>
<strong id="grammar-token--11">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token-structdef"><code class="xref docutils literal notranslate"><span class="pre">structdef</span></code></a>
<strong id="grammar-token--12">initial_defn </strong> ::=  <a class="reference internal" href="#grammar-token-c_code"><code class="xref docutils literal notranslate"><span class="pre">c_code</span></code></a>
</pre>
<pre>
<strong id="grammar-token-final_defns"><span id="grammar-token-final-defns"></span>final_defns</strong> ::=  <a class="reference internal" href="#grammar-token--13"><code class="xref docutils literal notranslate"><span class="pre">final_defns</span></code></a> <a class="reference internal" href="#grammar-token--15"><code class="xref docutils literal notranslate"><span class="pre">final_defn</span></code></a>
<strong id="grammar-token--13">final_defns</strong> ::= 
<strong id="grammar-token-final_defn"><span id="grammar-token-final-defn"></span>final_defn </strong> ::=  <a class="reference internal" href="#grammar-token-funcdef"><code class="xref docutils literal notranslate"><span class="pre">funcdef</span></code></a>
<strong id="grammar-token--14">final_defn </strong> ::=  <a class="reference internal" href="#grammar-token-structdef"><code class="xref docutils literal notranslate"><span class="pre">structdef</span></code></a>
<strong id="grammar-token--15">final_defn </strong> ::=  <a class="reference internal" href="#grammar-token-c_code"><code class="xref docutils literal notranslate"><span class="pre">c_code</span></code></a>
</pre>
<p>Global (top-level) definitions, see <a class="reference internal" href="#definitions">Definitions</a> for details. Note that
in the final definition section only function definitions and literal code
blocks are allowed.</p>
</div>
<div class="section" id="global-entry-and-exit-blocks">
<span id="globalentryexit"></span><h3>Global Entry and Exit Blocks<a class="headerlink" href="#global-entry-and-exit-blocks" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-entry">entry</strong> ::=  &quot;entry&quot; <a class="reference internal" href="#grammar-token-block"><code class="xref docutils literal notranslate"><span class="pre">block</span></code></a>
<strong id="grammar-token--16">entry</strong> ::= 
<strong id="grammar-token-exit">exit </strong> ::=  &quot;exit&quot; <a class="reference internal" href="#grammar-token-block"><code class="xref docutils literal notranslate"><span class="pre">block</span></code></a>
<strong id="grammar-token--17">exit </strong> ::= 
</pre>
<p>An SNL program may specify optional entry code to run prior to running the
state sets, and exit code to run after all state sets have exited. Both are
run in the context of the first state set thread.</p>
<p>(Global entry and exit blocks should not be confused with
<a class="reference internal" href="#state-entry-and-exit-blocks"><span class="std std-ref">State Entry and Exit Blocks</span></a>, which have the same syntax but are
executed at each <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> from/to a new state.)</p>
<p>The entry or exit code is a regular SNL code block and thus can contain local
variable declarations. Global entry code is always executed after initiating
connections to (named) PVs, and exit code is executed before connections are
shut down. Furthermore, if the global <a class="reference internal" href="Compiling.html#cmdoption-arg-c"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+c</span></code></a> option is in effect, the
entry code is executed only after all channels are connected and monitored
channels have received their first monitor event. All built-in PV functions
can be expected to work in global entry and exit blocks.</p>
<p>Note that global entry and exit blocks operate as if executed as part of the
first state set. This means that in <a class="reference internal" href="#safe-mode"><span class="std std-ref">Safe Mode</span></a> changes to global
variables made from inside the entry block are not visible to state sets
other than the first unless explicitly communicated (e.g. by calling pvPut).
The fact that the first state set plays a special role is a historical
accident, rather than conscious design. I might be tempted to redesign this
aspect in a future version, for instance by giving entry and exit blocks
their own dedicated virtual state set.</p>
</div>
<div class="section" id="final-c-code-block">
<h3>Final C Code Block<a class="headerlink" href="#final-c-code-block" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-c_code"><span id="grammar-token-c-code"></span>c_code</strong> ::=  <a class="reference internal" href="#grammar-token--1"><code class="xref docutils literal notranslate"><span class="pre">embedded_c_code</span></code></a>
</pre>
<p>Any number of embedded C code blocks may appear after state sets and the
optional exit block. See <a class="reference internal" href="EscapeToC.html#escape-to-c-code"><span class="std std-ref">Escape to C Code</span></a>.</p>
</div>
</div>
<div class="section" id="definitions">
<span id="id1"></span><h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="function-definitions">
<h3>Function Definitions<a class="headerlink" href="#function-definitions" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<pre>
<strong id="grammar-token-funcdef">funcdef</strong> ::=  <a class="reference internal" href="#grammar-token--38"><code class="xref docutils literal notranslate"><span class="pre">basetype</span></code></a> <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a> <a class="reference internal" href="#grammar-token-block"><code class="xref docutils literal notranslate"><span class="pre">block</span></code></a>
</pre>
<p>Function definitions are very much like those in C.</p>
<p>The most important difference is that functions declared in SNL get passed
certain implicit parameters. This makes it possible to call built-in
functions as if the code were a normal action block. Note, however, that
there is currently no way to <em>pass</em> channel (“assigned”) variables to SNL
functions in such a way that you can call built-in functions on them. The
“assigned” status of such a variable is lost and it gets passes to the
function as a normal C value. This means you can call built-in functions
that expect such a variable only if the variable was declared at the
top-level. Lifting this limitation is planned for a future release.</p>
<p>Another difference from C is that SNL functions automatically scope over the
whole program, no matter where they are defined. It is not necessary (but
allowed) to repeat the function declaration (without the defining code
block, commonly referred to as a “function prototype”) at the top of the
program.</p>
</div>
<div class="section" id="type-definitions">
<h3>Type Definitions<a class="headerlink" href="#type-definitions" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<pre>
<strong id="grammar-token-structdef">structdef   </strong> ::=  &quot;struct&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a> <a class="reference internal" href="#grammar-token-members"><code class="xref docutils literal notranslate"><span class="pre">members</span></code></a> &quot;;&quot;
<strong id="grammar-token-members">members     </strong> ::=  &quot;{&quot; <a class="reference internal" href="#grammar-token--18"><code class="xref docutils literal notranslate"><span class="pre">member_decls</span></code></a> &quot;}&quot;
<strong id="grammar-token-member_decls"><span id="grammar-token-member-decls"></span>member_decls</strong> ::=  <a class="reference internal" href="#grammar-token--19"><code class="xref docutils literal notranslate"><span class="pre">member_decl</span></code></a>
<strong id="grammar-token--18">member_decls</strong> ::=  <a class="reference internal" href="#grammar-token--18"><code class="xref docutils literal notranslate"><span class="pre">member_decls</span></code></a> <a class="reference internal" href="#grammar-token--19"><code class="xref docutils literal notranslate"><span class="pre">member_decl</span></code></a>
<strong id="grammar-token-member_decl"><span id="grammar-token-member-decl"></span>member_decl </strong> ::=  <a class="reference internal" href="#grammar-token--38"><code class="xref docutils literal notranslate"><span class="pre">basetype</span></code></a> <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a> &quot;;&quot;
<strong id="grammar-token--19">member_decl </strong> ::=  <a class="reference internal" href="#grammar-token-c_code"><code class="xref docutils literal notranslate"><span class="pre">c_code</span></code></a>
</pre>
<p>Type definitions are currently limited to struct definitions and may appear
only at the top level. They are translated to the equivalent struct
definition in C. Differences to C are that bit fields are not supported, and
that member types are limited to SNL types (built-in or user defined).</p>
</div>
<div class="section" id="variable-declarations">
<h3>Variable Declarations<a class="headerlink" href="#variable-declarations" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-declaration">declaration     </strong> ::=  <a class="reference internal" href="#grammar-token--38"><code class="xref docutils literal notranslate"><span class="pre">basetype</span></code></a> <a class="reference internal" href="#grammar-token--20"><code class="xref docutils literal notranslate"><span class="pre">init_declarators</span></code></a> &quot;;&quot;
<strong id="grammar-token-init_declarators"><span id="grammar-token-init-declarators"></span>init_declarators</strong> ::=  <a class="reference internal" href="#grammar-token--21"><code class="xref docutils literal notranslate"><span class="pre">init_declarator</span></code></a>
<strong id="grammar-token--20">init_declarators</strong> ::=  <a class="reference internal" href="#grammar-token--20"><code class="xref docutils literal notranslate"><span class="pre">init_declarators</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token--21"><code class="xref docutils literal notranslate"><span class="pre">init_declarator</span></code></a>
<strong id="grammar-token-init_declarator"><span id="grammar-token-init-declarator"></span>init_declarator </strong> ::=  <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a>
<strong id="grammar-token--21">init_declarator </strong> ::=  <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a> &quot;=&quot; <a class="reference internal" href="#grammar-token--28"><code class="xref docutils literal notranslate"><span class="pre">init_expr</span></code></a>
<strong id="grammar-token-declarator">declarator      </strong> ::=  <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a>
<strong id="grammar-token--22">declarator      </strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a> &quot;)&quot;
<strong id="grammar-token--23">declarator      </strong> ::=  <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a> <a class="reference internal" href="#grammar-token-subscript"><code class="xref docutils literal notranslate"><span class="pre">subscript</span></code></a>
<strong id="grammar-token--24">declarator      </strong> ::=  <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a> &quot;(&quot; <a class="reference internal" href="#grammar-token--65"><code class="xref docutils literal notranslate"><span class="pre">param_decls</span></code></a> &quot;)&quot;
<strong id="grammar-token--25">declarator      </strong> ::=  &quot;*&quot; <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a>
<strong id="grammar-token--26">declarator      </strong> ::=  &quot;const&quot; <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a>
<strong id="grammar-token-variable">variable        </strong> ::=  <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token-init_expr"><span id="grammar-token-init-expr"></span>init_expr       </strong> ::=  &quot;{&quot; <a class="reference internal" href="#grammar-token--30"><code class="xref docutils literal notranslate"><span class="pre">init_exprs</span></code></a> &quot;}&quot;
<strong id="grammar-token--27">init_expr       </strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token--55"><code class="xref docutils literal notranslate"><span class="pre">type_expr</span></code></a> &quot;)&quot; &quot;{&quot; <a class="reference internal" href="#grammar-token--30"><code class="xref docutils literal notranslate"><span class="pre">init_exprs</span></code></a> &quot;}&quot;
<strong id="grammar-token--28">init_expr       </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token-init_exprs"><span id="grammar-token-init-exprs"></span>init_exprs      </strong> ::=  <a class="reference internal" href="#grammar-token--30"><code class="xref docutils literal notranslate"><span class="pre">init_exprs</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token--28"><code class="xref docutils literal notranslate"><span class="pre">init_expr</span></code></a>
<strong id="grammar-token--29">init_exprs      </strong> ::=  <a class="reference internal" href="#grammar-token--28"><code class="xref docutils literal notranslate"><span class="pre">init_expr</span></code></a>
<strong id="grammar-token--30">init_exprs      </strong> ::= 
</pre>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>You can declare more than one variable in a single declaration (comma
separated) and add pointer and array markers (subscripts) ad libitum as
well as initializers.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2: </span>Function declarations and initializers with type casts.</p>
</div>
<p>As in C, some combinations of type operators are not allowed, for
instance because they are redundant (like declaring a function or array
<a class="reference internal" href="#const">const</a>). This is not specified in the SNL grammar. There are some
checks that warn about obviously wrong combinations, but as with type
checking, most of the work is off-loaded to the C compiler.</p>
<p>The also remain some limitations:</p>
<ul class="simple">
<li><p>arrays must have a defined size: the expression inside the subscript
brackets is not optional as in C; it must also be an integer literal,
not a constant expression as in C.</p></li>
<li><p>you cannot declare new types or type synonyms</p></li>
<li><p>the “volatile” type qualifier is not supported</p></li>
<li><p>neither are storage specifiers (“static”, “extern”, “auto”, register”)</p></li>
<li><p>only certain base types are allowed, see <a class="reference internal" href="#types"><span class="std std-ref">below</span></a>)</p></li>
</ul>
<p>Some of these restrictions may be lifted in future versions.</p>
<div class="section" id="const">
<h4>const<a class="headerlink" href="#const" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<p>As in C, declarations may involve the “const” keyword to make parts of
the thing declared constant i.e. immutable. The SNL syntax treats
“const” as a prefix type operator, exactly like the pointer “*”
operator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This correctly specifies a large subset of the C syntax, but there
are some limitations. For instance, in C you can write</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>const int x;   /* attention: invalid in SNL */
</pre></div>
</div>
<p>as an alternative notation for</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int const x;
</pre></div>
</div>
<p>This is not allowed in SNL to keep the parser simple and orthogonal.</p>
</div>
<p>Otherwise, “const” behaves like in C. For instance,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>char const *p;
</pre></div>
</div>
<p>declares a mutable pointer to constant char (possibly more than one),
while</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>char *const p;
</pre></div>
</div>
<p>declares a constant pointer to one or more mutable chars, and</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>char *const *p;
</pre></div>
</div>
<p>a constant pointer to constant chars.</p>
<p>As in C, declarations (and similarly <a class="reference internal" href="#type-expressions">Type Expressions</a>) should be read
inside out, starting with the identifier and working outwards,
respecting the precedences (postfix binds stronger than prefix). This
works for “const” exactly as for array subscripts, pointers, and
parameter lists.</p>
</div>
<div class="section" id="foreign-declarations">
<span id="foreign-entities"></span><h4>Foreign Declarations<a class="headerlink" href="#foreign-declarations" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.2.</span></p>
</div>
<pre>
<strong id="grammar-token--31">declaration</strong> ::=  &quot;foreign&quot; <a class="reference internal" href="#grammar-token--32"><code class="xref docutils literal notranslate"><span class="pre">variables</span></code></a> &quot;;&quot;
<strong id="grammar-token-variables">variables  </strong> ::=  <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a>
<strong id="grammar-token--32">variables  </strong> ::=  <a class="reference internal" href="#grammar-token--32"><code class="xref docutils literal notranslate"><span class="pre">variables</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a>
</pre>
<p>Foreign declarations are used to let the SNL compiler know about the
existence of C variables or C preprocessor macros (without parameters)
that have been  defined outside the SNL program or in escaped C code. No
warning will be issued if such a variable or macro is used in the
program even if warnings are enabled.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>It is no longer needed to declare struct or union members as foreign
entities, since the parser no longer confuses them with variables. See
section <a class="reference internal" href="#postfix-operators">Postfix Operators</a> below.</p>
<p>Also, warnings for undefined entities are now disabled by default. You
can use the “extra warnings” option <a class="reference internal" href="Compiling.html#cmdoption-arg-W"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+W</span></code></a> to enable them. In
contrast to older versions, this will also warn about foreign functions
when called from SNL code. Note that enabling extra warnings is normally
not needed: if a variable or function is actually undefined in the
generated C code, the C compiler will issue a warning (or an error)
anyway.</p>
</div>
<div class="section" id="basic-types">
<span id="types"></span><h4>Basic Types<a class="headerlink" href="#basic-types" title="Permalink to this headline">¶</a></h4>
<p>These are the allowed base types, of which you can declare variables,
or pointers or arrays etc.</p>
<pre>
<strong id="grammar-token-basetype">basetype</strong> ::=  <a class="reference internal" href="#grammar-token--54"><code class="xref docutils literal notranslate"><span class="pre">prim_type</span></code></a>
<strong id="grammar-token--33">basetype</strong> ::=  &quot;evflag&quot;
</pre>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<pre>
<strong id="grammar-token--34">basetype</strong> ::=  &quot;enum&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token--35">basetype</strong> ::=  &quot;struct&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token--36">basetype</strong> ::=  &quot;union&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token--37">basetype</strong> ::=  &quot;typename&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token--38">basetype</strong> ::=  &quot;void&quot;
</pre>
<p>You can use enumerations, structs, unions and typedefs in declarations
and type expressions. The “void” type is also allowed, subject to the
same restrictions as in C.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any use of a type alias (defined using “typedef” in C) <em>must</em>
be preceded by the “typename” keyword. This keyword has been borrowed
from C++, but in contrast to C++ using “typename” is <em>not</em> optional.</p>
</div>
<pre>
<strong id="grammar-token-prim_type"><span id="grammar-token-prim-type"></span>prim_type</strong> ::=  &quot;char&quot;
<strong id="grammar-token--39">prim_type</strong> ::=  &quot;short&quot;
<strong id="grammar-token--40">prim_type</strong> ::=  &quot;int&quot;
<strong id="grammar-token--41">prim_type</strong> ::=  &quot;long&quot;
<strong id="grammar-token--42">prim_type</strong> ::=  &quot;unsigned&quot; &quot;char&quot;
<strong id="grammar-token--43">prim_type</strong> ::=  &quot;unsigned&quot; &quot;short&quot;
<strong id="grammar-token--44">prim_type</strong> ::=  &quot;unsigned&quot; &quot;int&quot;
<strong id="grammar-token--45">prim_type</strong> ::=  &quot;unsigned&quot; &quot;long&quot;
<strong id="grammar-token--46">prim_type</strong> ::=  &quot;int8_t&quot;
<strong id="grammar-token--47">prim_type</strong> ::=  &quot;uint8_t&quot;
<strong id="grammar-token--48">prim_type</strong> ::=  &quot;int16_t&quot;
<strong id="grammar-token--49">prim_type</strong> ::=  &quot;uint16_t&quot;
<strong id="grammar-token--50">prim_type</strong> ::=  &quot;int32_t&quot;
<strong id="grammar-token--51">prim_type</strong> ::=  &quot;uint32_t&quot;
<strong id="grammar-token--52">prim_type</strong> ::=  &quot;float&quot;
<strong id="grammar-token--53">prim_type</strong> ::=  &quot;double&quot;
<strong id="grammar-token--54">prim_type</strong> ::=  &quot;string&quot;
</pre>
<p>Primitive types are those base types that correspond directly to some
(scalar) EPICS type. They have the same semantics as in C, except “string”
that does not exist in C. See subsection <a class="reference internal" href="#strings">Strings</a> below.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>Since the standard numeric types in C have implementation defined size, fixed
size integral types that correspond to the ones in the C99 standard have
been added. However, int64_t and uint64_t are not supported because
primitive types must correspond to the primitive EPICS types, and EPICS does
not yet support 64 bit integers.</p>
</div>
<div class="section" id="type-expressions">
<h4>Type Expressions<a class="headerlink" href="#type-expressions" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<pre>
<strong id="grammar-token-type_expr"><span id="grammar-token-type-expr"></span>type_expr  </strong> ::=  <a class="reference internal" href="#grammar-token--38"><code class="xref docutils literal notranslate"><span class="pre">basetype</span></code></a>
<strong id="grammar-token--55">type_expr  </strong> ::=  <a class="reference internal" href="#grammar-token--38"><code class="xref docutils literal notranslate"><span class="pre">basetype</span></code></a> <a class="reference internal" href="#grammar-token--63"><code class="xref docutils literal notranslate"><span class="pre">abs_decl</span></code></a>
<strong id="grammar-token-abs_decl"><span id="grammar-token-abs-decl"></span>abs_decl   </strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token--63"><code class="xref docutils literal notranslate"><span class="pre">abs_decl</span></code></a> &quot;)&quot;
<strong id="grammar-token--56">abs_decl   </strong> ::=  <a class="reference internal" href="#grammar-token-subscript"><code class="xref docutils literal notranslate"><span class="pre">subscript</span></code></a>
<strong id="grammar-token--57">abs_decl   </strong> ::=  <a class="reference internal" href="#grammar-token--63"><code class="xref docutils literal notranslate"><span class="pre">abs_decl</span></code></a> <a class="reference internal" href="#grammar-token-subscript"><code class="xref docutils literal notranslate"><span class="pre">subscript</span></code></a>
<strong id="grammar-token--58">abs_decl   </strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token--65"><code class="xref docutils literal notranslate"><span class="pre">param_decls</span></code></a> &quot;)&quot;
<strong id="grammar-token--59">abs_decl   </strong> ::=  <a class="reference internal" href="#grammar-token--63"><code class="xref docutils literal notranslate"><span class="pre">abs_decl</span></code></a> &quot;(&quot; <a class="reference internal" href="#grammar-token--65"><code class="xref docutils literal notranslate"><span class="pre">param_decls</span></code></a> &quot;)&quot;
<strong id="grammar-token--60">abs_decl   </strong> ::=  &quot;*&quot;
<strong id="grammar-token--61">abs_decl   </strong> ::=  &quot;*&quot; <a class="reference internal" href="#grammar-token--63"><code class="xref docutils literal notranslate"><span class="pre">abs_decl</span></code></a>
<strong id="grammar-token--62">abs_decl   </strong> ::=  &quot;const&quot;
<strong id="grammar-token--63">abs_decl   </strong> ::=  &quot;const&quot; <a class="reference internal" href="#grammar-token--63"><code class="xref docutils literal notranslate"><span class="pre">abs_decl</span></code></a>
<strong id="grammar-token-param_decls"><span id="grammar-token-param-decls"></span>param_decls</strong> ::= 
<strong id="grammar-token--64">param_decls</strong> ::=  <a class="reference internal" href="#grammar-token--66"><code class="xref docutils literal notranslate"><span class="pre">param_decl</span></code></a>
<strong id="grammar-token--65">param_decls</strong> ::=  <a class="reference internal" href="#grammar-token--65"><code class="xref docutils literal notranslate"><span class="pre">param_decls</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token--66"><code class="xref docutils literal notranslate"><span class="pre">param_decl</span></code></a>
<strong id="grammar-token-param_decl"><span id="grammar-token-param-decl"></span>param_decl </strong> ::=  <a class="reference internal" href="#grammar-token--38"><code class="xref docutils literal notranslate"><span class="pre">basetype</span></code></a> <a class="reference internal" href="#grammar-token--26"><code class="xref docutils literal notranslate"><span class="pre">declarator</span></code></a>
<strong id="grammar-token--66">param_decl </strong> ::=  <a class="reference internal" href="#grammar-token--55"><code class="xref docutils literal notranslate"><span class="pre">type_expr</span></code></a>
</pre>
<p>Type expressions closely follow declaration syntax just as in C. They
are used for parameter declarations as well as type casts and the
special sizeof operator (see <a class="reference internal" href="#prefix-operators">Prefix Operators</a>).</p>
<p>Using “const” in type expressions is subject to the same restrictions as
in declarations (see <a class="reference internal" href="#variable-declarations">Variable Declarations</a>).</p>
</div>
<div class="section" id="strings">
<h4>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h4>
<p>The type <code class="docutils literal notranslate"><span class="pre">string</span></code> is defined in C as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>typedef char string[MAX_STRING_SIZE];
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">MAX_STRING_SIZE</span></code> is a constant defined in one of the
included header files from EPICS base. I know of no EPICS version
where it is different from 40, but to be on the safe side I
recommend not to rely too much on the numeric value. (You can use
<code class="docutils literal notranslate"><span class="pre">sizeof(string)</span></code> in SNL expressions.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In contrast to C, in SNL <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">s</span></code> is <em>not</em> a synonym for
<code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">s[MAX_STRING_SIZE]</span></code>, since variables of type <code class="docutils literal notranslate"><span class="pre">string</span></code>
are treated differently when it comes to interacting with PVs: the
former gets requested with type DBR_STRING and a count of one, while
the latter gets requested with type DBR_CHAR and a count of
<code class="docutils literal notranslate"><span class="pre">MAX_STRING_SIZE</span></code>.</p>
</div>
</div>
<div class="section" id="event-flags">
<h4>Event Flags<a class="headerlink" href="#event-flags" title="Permalink to this headline">¶</a></h4>
<p>Event flags are values of an abstract data type with four operations
defined on them: <a class="reference internal" href="#c.efSet" title="efSet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efSet</span></code></a>, <a class="reference internal" href="#c.efClear" title="efClear"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efClear</span></code></a>, <a class="reference internal" href="#c.efTest" title="efTest"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTest</span></code></a>,
and <a class="reference internal" href="#c.efTestAndClear" title="efTestAndClear"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTestAndClear</span></code></a>.</p>
<p>An event flag <code class="docutils literal notranslate"><span class="pre">e</span></code> can act as a binary semaphore, allowing exactly one
state set to continue, if <code class="docutils literal notranslate"><span class="pre">when(efTestAndClear(e))</span></code> is used to wait
and <code class="docutils literal notranslate"><span class="pre">efSet(e)</span></code> to signal. Event flags can be coupled to changes of a
PV using the <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a> clause, so that the flag gets set whenever
an event happens.</p>
<p>You cannot declare arrays of or pointers to event flags, since
event flags are not translated to C variables in your program.</p>
<p>See <a class="reference internal" href="Tutorial.html#eventflags"><span class="std std-ref">Synchronizing State Sets with Event Flags</span></a>.</p>
</div>
</div>
<div class="section" id="variable-scope-and-life-time">
<span id="variable-scope"></span><h3>Variable Scope and Life Time<a class="headerlink" href="#variable-scope-and-life-time" title="Permalink to this headline">¶</a></h3>
<p>Variables are statically scoped, i.e. they are visible and accessible to the
program only inside the smallest <a class="reference internal" href="#grammar-token-block"><code class="xref any std std-token docutils literal notranslate"><span class="pre">block</span></code></a> enclosing the declaration;
if declared outside of any block, i.e. at the top level, they are visible
everywhere in the program.</p>
<p>This is quite similar to C and other statically scoped programming
languages. However, there are two differences to C:</p>
<p>First, global variables are always local to the program, similar to
variables that have been declared “static” in C.</p>
<p>Second, in C, a variable’s life time is defined by its scope: when the scope
is left, the variable becomes undefined. That is, life time (also called
dynamic scope) follows static scope. This is generally the same in SNL, with
two notable <em>exceptions</em>: A variable declared local to a state set or local
to a state continues to exist <em>as long as the program runs</em>, just as if it
were declared at the top level, i.e. before any state sets. We say that such
variables have  <em>global life time</em>.</p>
<p>Only variables with global life time can be assigned to a process variable,
monitored, synced etc. If they have an initializer, they will be initialized
only once when the program starts.</p>
<p>Variables declared local to an action block or a compound statement behave
exactly as in C. They can <em>not</em> be assigned to a PV; and (if they have an
initializer) they become re-initialized each time the block is entered.</p>
<p>The rationale for this is that, while bringing a normal variable into and
out of scope is a very cheap operation, establishing a connection to a PV is
not.</p>
</div>
<div class="section" id="variable-initialization">
<h3>Variable Initialization<a class="headerlink" href="#variable-initialization" title="Permalink to this headline">¶</a></h3>
<p>Initializers for variables of global life time (i.e. globals as well as
state set and state local ones) must respect the usual C rules for static
variable initializers. Particularly, they must be <em>constant expressions</em> in
the C sense, i.e. calculable at compile time, which also means they must not
refer to other variables.</p>
<p>Variables of global life time are initialized before <em>any</em> other code is
executed.</p>
<p>Initializers for other variables (i.e. those with local lifetime) behave
exactly as regular local C variables. Particularly, an initializer for such
a variable may refer to other variables that have been declared (and,
possibly, initialized) in an outer scope, and also to those that have
previously been declared (and, possibly, initialized) in the same scope.</p>
</div>
<div class="section" id="process-variables">
<h3>Process Variables<a class="headerlink" href="#process-variables" title="Permalink to this headline">¶</a></h3>
<p>The syntactic constructs in this section allow program variables to be
connected to externally defined process variables.</p>
<div class="section" id="assign">
<h4>assign<a class="headerlink" href="#assign" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-assign">assign   </strong> ::=  &quot;assign&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token--70"><code class="xref docutils literal notranslate"><span class="pre">to</span></code></a> <a class="reference internal" href="#grammar-token-string"><code class="xref docutils literal notranslate"><span class="pre">string</span></code></a> &quot;;&quot;
<strong id="grammar-token--67">assign   </strong> ::=  &quot;assign&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token-subscript"><code class="xref docutils literal notranslate"><span class="pre">subscript</span></code></a> <a class="reference internal" href="#grammar-token--70"><code class="xref docutils literal notranslate"><span class="pre">to</span></code></a> <a class="reference internal" href="#grammar-token-string"><code class="xref docutils literal notranslate"><span class="pre">string</span></code></a> &quot;;&quot;
<strong id="grammar-token--68">assign   </strong> ::=  &quot;assign&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token--70"><code class="xref docutils literal notranslate"><span class="pre">to</span></code></a> &quot;{&quot; <a class="reference internal" href="#grammar-token--72"><code class="xref docutils literal notranslate"><span class="pre">strings</span></code></a> &quot;}&quot; &quot;;&quot;
<strong id="grammar-token--69">assign   </strong> ::=  &quot;assign&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> &quot;;&quot;
<strong id="grammar-token-to">to       </strong> ::=  &quot;to&quot;
<strong id="grammar-token--70">to       </strong> ::= 
<strong id="grammar-token-strings">strings  </strong> ::=  <a class="reference internal" href="#grammar-token--72"><code class="xref docutils literal notranslate"><span class="pre">strings</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token-string"><code class="xref docutils literal notranslate"><span class="pre">string</span></code></a>
<strong id="grammar-token--71">strings  </strong> ::=  <a class="reference internal" href="#grammar-token-string"><code class="xref docutils literal notranslate"><span class="pre">string</span></code></a>
<strong id="grammar-token--72">strings  </strong> ::= 
<strong id="grammar-token-subscript">subscript</strong> ::=  &quot;[&quot; <a class="reference internal" href="#grammar-token-integer_literal"><code class="xref docutils literal notranslate"><span class="pre">integer_literal</span></code></a> &quot;]&quot;
</pre>
<p>This assigns or connects program variables to named or anonymous process
variables.</p>
<p>There are four variants of the <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> statement. The first one
assigns a (scalar or array) variable to a single process variable.
The second one assigns a single element of an array variable to a
single process variable. The third one assigns elements of an array
variable to separate process variables.</p>
<p>For the third variant, if the number of PV names does not match the number
of elements in the array, then the rule is that</p>
<ul class="simple">
<li><p>missing PV names default to “”, and</p></li>
<li><p>excess PV names are discarded.</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>The fourth variant serves as an abbreviation for
the first variant, in the special case where the PV name is empty (<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>).</p>
<p>Assigned variables must be of global life time, see
<a class="reference internal" href="#variable-scope"><span class="std std-ref">Variable Scope and Life Time</span></a>. Assigned variables, or separately assigned
elements of an array, can be used as argument to built-in <code class="docutils literal notranslate"><span class="pre">pvXXX</span></code>
procedures (see <a class="reference internal" href="#built-in-functions">Built-in Functions</a>). This is the primary means of
interacting with process variables from within an SNL program.</p>
<p>Only certain types of variables can be assigned to a PV: allowed
are numeric types (char, short, int, long, and their unsigned variants)
and strings (these are sometimes referred to as <em>scalar types</em>), as well
as one or two dimensional arrays of these.</p>
<p>Process variable names are subject to <em>parameter expansion</em>: substrings
of the form</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{parametername}
</pre></div>
</div>
<p>(i.e. an identifier enclosed in curly braces) are expanded to the value of
the program parameter <em>if</em> a corresponding parameter is defined (either
inside the program or as an extra argument on invocation, see <a class="reference internal" href="Using.html#c.seq" title="seq"><code class="xref any c c-func docutils literal notranslate"><span class="pre">seq</span></code></a>);
otherwise no expansion takes place.</p>
<p>If the process variable name (after expansion) is an empty string, then no
actual assignment to any process variable is performed, but the variable
is marked for potential (dynamic) assignment with <a class="reference internal" href="#c.pvAssign" title="pvAssign"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvAssign</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> clause using an empty string for the PV name is
interpreted differently in <a class="reference internal" href="#safe-mode"><span class="std std-ref">Safe Mode</span></a>, see <a class="reference internal" href="#anonymous-pvs"><span class="std std-ref">Anonymous Channels</span></a>.</p>
</div>
<p>An array variable assigned wholesale to one process variable (using
the first syntactic variant above) or an element of a
two-dimensional variable assigned to an array process variable
(using the second syntactic variant) will use either the length of
the array or the native count for the underlying process
variable, whichever is smaller, when communicating with the
underlying process variable. The native count is determined when a
connection is established. For anonymous PVs, the length of the array is
used.</p>
<p>Pointer types may not be assigned to process variables.</p>
</div>
<div class="section" id="monitor">
<h4>monitor<a class="headerlink" href="#monitor" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-monitor">monitor      </strong> ::=  &quot;monitor&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token--73"><code class="xref docutils literal notranslate"><span class="pre">opt_subscript</span></code></a> &quot;;&quot;
<strong id="grammar-token-opt_subscript"><span id="grammar-token-opt-subscript"></span>opt_subscript</strong> ::=  <a class="reference internal" href="#grammar-token-subscript"><code class="xref docutils literal notranslate"><span class="pre">subscript</span></code></a>
<strong id="grammar-token--73">opt_subscript</strong> ::= 
</pre>
<p>This sets up a monitor for an assigned variable or array element.</p>
<p>Monitored variables are automatically updated whenever the underlying
process variable changes its value. Note, however, that this depends on
the configuration of the underlying PV: some PVs post an update event
only if the value changes by at least a certain amount. Also, events may
be posted, even if no actual change happens, i.e. the value remains the
same. The details can be found in the <a class="reference external" href="http://www.aps.anl.gov/epics/wiki/index.php/RRM_3-14">EPICS Record Reference Manual</a>.</p>
</div>
<div class="section" id="sync">
<h4>sync<a class="headerlink" href="#sync" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-sync">sync      </strong> ::=  &quot;sync&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token--73"><code class="xref docutils literal notranslate"><span class="pre">opt_subscript</span></code></a> <a class="reference internal" href="#grammar-token--70"><code class="xref docutils literal notranslate"><span class="pre">to</span></code></a> <a class="reference internal" href="#grammar-token-event_flag"><code class="xref docutils literal notranslate"><span class="pre">event_flag</span></code></a> &quot;;&quot;
<strong id="grammar-token-event_flag"><span id="grammar-token-event-flag"></span>event_flag</strong> ::=  <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
</pre>
<p>This declares a variable to be synchronized with an event flag.</p>
<p>When a monitor is posted on any of the process variables associated
with the event flag (and these are <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a>ed), or when an
asynchronous get or put operation completes, the corresponding event
flag is set.</p>
<p>The variable must be <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a>ed and <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a>ed.
A variable can be mentioned in at most one sync clause, but an event
flag may appear in more than one such clause. The variable may be an
array, and as such may be associated with multiple process variables.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1.</span></p>
</div>
<ul class="simple">
<li><p>It is now allowed to sync an event flag to more than one variable.</p></li>
<li><p>There is now a run-time equivalent to the sync clause, see the
built-in function <a class="reference internal" href="#c.pvSync" title="pvSync"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvSync</span></code></a>.</p></li>
</ul>
</div>
<div class="section" id="syncq">
<h4>syncQ<a class="headerlink" href="#syncq" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-syncq">syncq     </strong> ::=  &quot;syncq&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token--73"><code class="xref docutils literal notranslate"><span class="pre">opt_subscript</span></code></a> <a class="reference internal" href="#grammar-token--70"><code class="xref docutils literal notranslate"><span class="pre">to</span></code></a> <a class="reference internal" href="#grammar-token-event_flag"><code class="xref docutils literal notranslate"><span class="pre">event_flag</span></code></a> <a class="reference internal" href="#grammar-token--75"><code class="xref docutils literal notranslate"><span class="pre">syncq_size</span></code></a> &quot;;&quot;
<strong id="grammar-token--74">syncq     </strong> ::=  &quot;syncq&quot; <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a> <a class="reference internal" href="#grammar-token--73"><code class="xref docutils literal notranslate"><span class="pre">opt_subscript</span></code></a> <a class="reference internal" href="#grammar-token--75"><code class="xref docutils literal notranslate"><span class="pre">syncq_size</span></code></a> &quot;;&quot;
<strong id="grammar-token-syncq_size"><span id="grammar-token-syncq-size"></span>syncq_size</strong> ::=  <a class="reference internal" href="#grammar-token-integer_literal"><code class="xref docutils literal notranslate"><span class="pre">integer_literal</span></code></a>
<strong id="grammar-token--75">syncq_size</strong> ::= 
</pre>
<p>This declares a variable to be queued.</p>
<p>When a monitor is posted on any of the process variables associated
with the given program variable, the new value is written to the end
of the queue. If the queue is already full, the last (youngest) entry
is overwritten. The <a class="reference internal" href="#c.pvGetQ" title="pvGetQ"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetQ</span></code></a> function reads items from the
queue.</p>
<p>The variable must be <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a>ed and <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a>ed.
Specifying a size (number of elements) for the queue is optional. If
a size is given, it must be a positive decimal number, denoting the
maximum number of elements that can be stored in the queue. A
missing size means that it defaults to 100 elements. The variable can
be an array, and may be associated with multiple process variables, in
which case there is still only one queue, but any change in any of the
involved PVs will add an entry to the queue.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>You can use “syncq” (all lower case) as keyword instead of “syncQ”. The
latter may be deprecated in a future version.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1.</span></p>
</div>
<p>Not giving a queue size (thus relying on the default of 100 elements)
is now <em>deprecated</em> and the compiler will issue a warning. The reason
for this is that queues are now statically allocated, which can result
in a large memory overhead especially if the variable is an array
associated with a single PV. (A default queue size of 1 would be much
more useful, but for compatibility I kept it at 100 as in previous
versions.)</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1.</span></p>
</div>
<p>A queued variable no longer needs to be associated with an event flag.
The first form of the <a class="reference internal" href="#grammar-token--74"><code class="xref any std std-token docutils literal notranslate"><span class="pre">syncq</span></code></a> clause is now merely an
abbreviation for a <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a> clause together with a <a class="reference internal" href="#grammar-token--74"><code class="xref any std std-token docutils literal notranslate"><span class="pre">syncq</span></code></a>
of the second form, i.e.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>syncq var to ef qsize;
</pre></div>
</div>
<p>is equivalent to</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sync var to ef;
syncq var qsize;
</pre></div>
</div>
<p>Forcing the association with an event flag was never really necessary,
since <a class="reference internal" href="#c.pvGetQ" title="pvGetQ"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetQ</span></code></a> already checks and returns whether the queue is
empty or not; and any state set that mentions a variable in a
<a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clause automatically gets woken up whenever the variable
changes due to a monitor event. On the other hand, relying on the event
flag being set as an indication that the queue is non-empty has always
been unreliable since another <a class="reference internal" href="#c.pvGetQ" title="pvGetQ"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetQ</span></code></a> might have intervened and emptied
the queue between the two calls.</p>
<p>Note that <a class="reference internal" href="#c.pvGetQ" title="pvGetQ"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetQ</span></code></a> clears an event flag associated with the variable if
the queue becomes empty after removing the head element.</p>
</div>
</div>
<div class="section" id="option">
<span id="option-definition"></span><h3>Option<a class="headerlink" href="#option" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-option">option      </strong> ::=  &quot;option&quot; <a class="reference internal" href="#grammar-token--76"><code class="xref docutils literal notranslate"><span class="pre">option_value</span></code></a> <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a> &quot;;&quot;
<strong id="grammar-token-option_value"><span id="grammar-token-option-value"></span>option_value</strong> ::=  &quot;+&quot;
<strong id="grammar-token--76">option_value</strong> ::=  &quot;-&quot;
</pre>
<p>The option name is any combination
of option letters. Multiple options can be clobbered into a single
option clause, but only a single option value is allowed.
Option value “+” turns the given options on, a”-” turns them off.</p>
<p>Examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>option +r; /* make code reentrant */
option -ca; /* synchronous pvGet and don&#39;t wait for channels to connect */
</pre></div>
</div>
<p>Unknown option letters cause a warning to be issued, but are otherwise
ignored.</p>
<p>The same syntax is used for global options and state options. The
interpretation, however, is different:</p>
<p>Global (top-level) options are interpreted as if the corresponding
compiler option had been given on the command line (see
<a class="reference internal" href="Compiling.html#compileroptions"><span class="std std-ref">Compiler Options</span></a>). Global option definitions take precedence over
options given to the compiler on the command line.</p>
<p>State options occur inside the state construct and affect only the
state in which they are defined, see <a class="reference internal" href="#state-option">State Option</a>.</p>
</div>
</div>
<div class="section" id="state-set">
<h2>State Set<a class="headerlink" href="#state-set" title="Permalink to this headline">¶</a></h2>
<pre>
<strong id="grammar-token-state_sets"><span id="grammar-token-state-sets"></span>state_sets</strong> ::=  <a class="reference internal" href="#grammar-token--77"><code class="xref docutils literal notranslate"><span class="pre">state_sets</span></code></a> <a class="reference internal" href="#grammar-token-state_set"><code class="xref docutils literal notranslate"><span class="pre">state_set</span></code></a>
<strong id="grammar-token--77">state_sets</strong> ::=  <a class="reference internal" href="#grammar-token-state_set"><code class="xref docutils literal notranslate"><span class="pre">state_set</span></code></a>
<strong id="grammar-token-state_set"><span id="grammar-token-state-set"></span>state_set </strong> ::=  &quot;ss&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a> &quot;{&quot; <a class="reference internal" href="#grammar-token--78"><code class="xref docutils literal notranslate"><span class="pre">ss_defns</span></code></a> <a class="reference internal" href="#grammar-token--83"><code class="xref docutils literal notranslate"><span class="pre">states</span></code></a> &quot;}&quot;
<strong id="grammar-token-ss_defns"><span id="grammar-token-ss-defns"></span>ss_defns  </strong> ::=  <a class="reference internal" href="#grammar-token--78"><code class="xref docutils literal notranslate"><span class="pre">ss_defns</span></code></a> <a class="reference internal" href="#grammar-token--82"><code class="xref docutils literal notranslate"><span class="pre">ss_defn</span></code></a>
<strong id="grammar-token--78">ss_defns  </strong> ::= 
</pre>
<p>A program contains one or more state sets. Each state set is
defined by the keyword “ss”, followed by the name of the state set (an
identifier). After that comes an opening brace, optionally state set
local definitions, a list of states, and then a closing brace.</p>
<p>State set names must be unique in the program.</p>
<div class="section" id="state-set-local-definition">
<h3>State Set Local Definition<a class="headerlink" href="#state-set-local-definition" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-ss_defn"><span id="grammar-token-ss-defn"></span>ss_defn</strong> ::=  <a class="reference internal" href="#grammar-token--69"><code class="xref docutils literal notranslate"><span class="pre">assign</span></code></a>
<strong id="grammar-token--79">ss_defn</strong> ::=  <a class="reference internal" href="#grammar-token-monitor"><code class="xref docutils literal notranslate"><span class="pre">monitor</span></code></a>
<strong id="grammar-token--80">ss_defn</strong> ::=  <a class="reference internal" href="#grammar-token-sync"><code class="xref docutils literal notranslate"><span class="pre">sync</span></code></a>
<strong id="grammar-token--81">ss_defn</strong> ::=  <a class="reference internal" href="#grammar-token--74"><code class="xref docutils literal notranslate"><span class="pre">syncq</span></code></a>
<strong id="grammar-token--82">ss_defn</strong> ::=  <a class="reference internal" href="#grammar-token--31"><code class="xref docutils literal notranslate"><span class="pre">declaration</span></code></a>
</pre>
<p>Inside state sets are allowed variable declarations and process variable
definitions (<a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a>, <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a>, <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a>, and
<a class="reference internal" href="#grammar-token--74"><code class="xref any std std-token docutils literal notranslate"><span class="pre">syncq</span></code></a>).</p>
<p>See <a class="reference internal" href="#variable-scope">variable scope</a> for details on what local definitions mean.</p>
</div>
<div class="section" id="state">
<h3>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-states">states     </strong> ::=  <a class="reference internal" href="#grammar-token--83"><code class="xref docutils literal notranslate"><span class="pre">states</span></code></a> <a class="reference internal" href="#grammar-token-state"><code class="xref docutils literal notranslate"><span class="pre">state</span></code></a>
<strong id="grammar-token--83">states     </strong> ::=  <a class="reference internal" href="#grammar-token-state"><code class="xref docutils literal notranslate"><span class="pre">state</span></code></a>
<strong id="grammar-token-state">state      </strong> ::=  &quot;state&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a> &quot;{&quot; <a class="reference internal" href="#grammar-token--84"><code class="xref docutils literal notranslate"><span class="pre">state_defns</span></code></a> <a class="reference internal" href="#grammar-token--16"><code class="xref docutils literal notranslate"><span class="pre">entry</span></code></a> <a class="reference internal" href="#grammar-token--90"><code class="xref docutils literal notranslate"><span class="pre">transitions</span></code></a> <a class="reference internal" href="#grammar-token--17"><code class="xref docutils literal notranslate"><span class="pre">exit</span></code></a> &quot;}&quot;
<strong id="grammar-token-state_defns"><span id="grammar-token-state-defns"></span>state_defns</strong> ::=  <a class="reference internal" href="#grammar-token--84"><code class="xref docutils literal notranslate"><span class="pre">state_defns</span></code></a> <a class="reference internal" href="#grammar-token--89"><code class="xref docutils literal notranslate"><span class="pre">state_defn</span></code></a>
<strong id="grammar-token--84">state_defns</strong> ::= 
</pre>
<p>A state set contains one or more states. Each state is defined by the
keyword “state”, followed by the name of the state (and identifier),
followed by an opening brace, optionally state local definitions, an
optional entry block, a list of <a class="reference internal" href="#grammar-token--90"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transitions</span></code></a>, an optional exit block,
and finally a closing brace.</p>
<p>State names must be unique in the sate set to which they belong.</p>
<div class="section" id="state-local-definition">
<h4>State Local Definition<a class="headerlink" href="#state-local-definition" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-state_defn"><span id="grammar-token-state-defn"></span>state_defn</strong> ::=  <a class="reference internal" href="#grammar-token--69"><code class="xref docutils literal notranslate"><span class="pre">assign</span></code></a>
<strong id="grammar-token--85">state_defn</strong> ::=  <a class="reference internal" href="#grammar-token-monitor"><code class="xref docutils literal notranslate"><span class="pre">monitor</span></code></a>
<strong id="grammar-token--86">state_defn</strong> ::=  <a class="reference internal" href="#grammar-token-sync"><code class="xref docutils literal notranslate"><span class="pre">sync</span></code></a>
<strong id="grammar-token--87">state_defn</strong> ::=  <a class="reference internal" href="#grammar-token--74"><code class="xref docutils literal notranslate"><span class="pre">syncq</span></code></a>
<strong id="grammar-token--88">state_defn</strong> ::=  <a class="reference internal" href="#grammar-token--31"><code class="xref docutils literal notranslate"><span class="pre">declaration</span></code></a>
<strong id="grammar-token--89">state_defn</strong> ::=  <a class="reference internal" href="#grammar-token-option"><code class="xref docutils literal notranslate"><span class="pre">option</span></code></a>
</pre>
</div>
<div class="section" id="state-option">
<span id="stateoption"></span><h4>State Option<a class="headerlink" href="#state-option" title="Permalink to this headline">¶</a></h4>
<p>The syntax for a state option is the same as for global options
(see <a class="reference internal" href="#option-definition"><span class="std std-ref">Option</span></a>).</p>
<p>The state options are:</p>
<dl class="option-list" id="state-option-t">
<dt><kbd><span class="option">+t</span></kbd></dt>
<dd><p>Reset delay timers each time the state is entered, even if entered
from the same state. This is the default.</p>
</dd>
</dl>
<dl class="option-list" id="id3">
<dt><kbd><span class="option">-t</span></kbd></dt>
<dd><p>Don’t reset delay timers when entering from the same state. In other
words, the <a class="reference internal" href="#c.delay" title="delay"><code class="xref any c c-func docutils literal notranslate"><span class="pre">delay</span></code></a> function will return whether the specified
time has elapsed from the moment the current state was entered from a
different state, rather than from when it was entered for the current
iteration.</p>
</dd>
</dl>
<dl class="option-list" id="state-option-e">
<dt><kbd><span class="option">+e</span></kbd></dt>
<dd><p>Execute <a class="reference internal" href="#grammar-token--16"><code class="xref any std std-token docutils literal notranslate"><span class="pre">entry</span></code></a> blocks only if the previous state was
not the same as the current state. This is the default.</p>
</dd>
</dl>
<dl class="option-list" id="id4">
<dt><kbd><span class="option">-e</span></kbd></dt>
<dd><p>Execute <a class="reference internal" href="#grammar-token--16"><code class="xref any std std-token docutils literal notranslate"><span class="pre">entry</span></code></a> blocks even if the previous state was the same
as the current state.</p>
</dd>
</dl>
<dl class="option-list" id="state-option-x">
<dt><kbd><span class="option">+x</span></kbd></dt>
<dd><p>Execute <a class="reference internal" href="#grammar-token--17"><code class="xref any std std-token docutils literal notranslate"><span class="pre">exit</span></code></a> blocks only if the next state is not the same as
the current state. This is the default.</p>
</dd>
</dl>
<dl class="option-list" id="id5">
<dt><kbd><span class="option">-x</span></kbd></dt>
<dd><p>Execute <a class="reference internal" href="#grammar-token--17"><code class="xref any std std-token docutils literal notranslate"><span class="pre">exit</span></code></a> blocks even if the next state is the same as
the current state.</p>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>state low {
   option -e; /* Do entry{} every time ... */
   option +x; /* but only do exit{} when really leaving */
   entry { ... }
   ...when ()...
   exit { ... }
}
</pre></div>
</div>
</div>
<div class="section" id="state-entry-and-exit-blocks">
<span id="id6"></span><h4>State Entry and Exit Blocks<a class="headerlink" href="#state-entry-and-exit-blocks" title="Permalink to this headline">¶</a></h4>
<p>The syntax is the same as for <a class="reference internal" href="#global-entry-and-exit-blocks">Global Entry and Exit Blocks</a>.</p>
<p>Entry blocks are executed when the state is entered, before any of the
<a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>s for state <a class="reference internal" href="#grammar-token--90"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transitions</span></code></a> are evaluated.</p>
<p>Exit blocks are executed when the state is left, after the <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a>
block that determines the next state.</p>
</div>
<div class="section" id="transitions">
<h4>Transitions<a class="headerlink" href="#transitions" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-transitions">transitions</strong> ::=  <a class="reference internal" href="#grammar-token--90"><code class="xref docutils literal notranslate"><span class="pre">transitions</span></code></a> <a class="reference internal" href="#grammar-token--91"><code class="xref docutils literal notranslate"><span class="pre">transition</span></code></a>
<strong id="grammar-token--90">transitions</strong> ::=  <a class="reference internal" href="#grammar-token--91"><code class="xref docutils literal notranslate"><span class="pre">transition</span></code></a>
<strong id="grammar-token-transition">transition </strong> ::=  &quot;when&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token-condition"><code class="xref docutils literal notranslate"><span class="pre">condition</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token-block"><code class="xref docutils literal notranslate"><span class="pre">block</span></code></a> &quot;state&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
<strong id="grammar-token-condition">condition  </strong> ::=  <a class="reference internal" href="#grammar-token--158"><code class="xref docutils literal notranslate"><span class="pre">opt_expr</span></code></a>
</pre>
<p>A state transition starts with the keyword “when”, followed by a condition
(in parentheses), followed by a block, and finally the keyword “state” and
then the name of the target state (which must be a state of the same state
set).</p>
<p>The condition must be a valid boolean expression (see <a class="reference internal" href="#expressions">Expressions</a>). If
there is no condition given, it defaults to <a class="reference internal" href="#c.seqBool" title="seqBool"><code class="xref any c c-type docutils literal notranslate"><span class="pre">TRUE</span></code></a>.</p>
<p>Conditions are evaluated</p>
<ol class="arabic simple">
<li><p>when the state is entered (after entry block execution), and</p></li>
<li><p>when an event happens (see below).</p></li>
</ol>
<p>Evaluation proceeds in the order in which the <a class="reference internal" href="#grammar-token--90"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transitions</span></code></a> appear in the
program. If one of the <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>s evaluates to <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>, the
corresponding action block is executed, any exit block of the state is
executed, and the state changes to the specified new state. Otherwise, the
state set waits until an event happens.</p>
<p>There are five types of event:</p>
<ul class="simple">
<li><p>a process variable monitor is posted</p></li>
<li><p>an asynchronous <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> or <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> completes</p></li>
<li><p>a <a class="reference internal" href="#c.delay" title="delay"><code class="xref any c c-func docutils literal notranslate"><span class="pre">delay</span></code></a> timer expires</p></li>
<li><p>an event flag is set or cleared</p></li>
<li><p>a process variable connects or disconnects</p></li>
</ul>
<p>While the sequencer’s runtime system and the compiler work together to
minimize evaluation of conditions, there is no guarantee whatsoever about
the number of times conditions might be evaluated before one of them returns
<a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>.</p>
<p>Conditions are usually written so that they have no side-effects. This
ensures that it does not matter how often they are evaluated or in which
order.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a condition has a side-effect, care should be taken to ensure that the
effect is limited to the case when the whole(!) condition fires (returns
<a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>), so that it will occur at most once. Otherwise you will have no
control over when and how often the effect happens.</p>
<p>Built-in functions that have side-effects and are suitable for use in
conditions, notably <a class="reference internal" href="#c.efTestAndClear" title="efTestAndClear"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTestAndClear</span></code></a> and <a class="reference internal" href="#c.pvGetQ" title="pvGetQ"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetQ</span></code></a>, meet this criterion,
but only of used by themselves alone. If used as part of a larger
expression, the whole condition might no longer meet the citerion.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<pre>
<strong id="grammar-token--91">transition</strong> ::=  &quot;when&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token-condition"><code class="xref docutils literal notranslate"><span class="pre">condition</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token-block"><code class="xref docutils literal notranslate"><span class="pre">block</span></code></a> &quot;exit&quot;
</pre>
<p>Instead of declaring which should be the next state, one can use the single
keyword “exit”. This has the same effect as a call to the <a class="reference internal" href="Using.html#c.seqStop" title="seqStop"><code class="xref any c c-func docutils literal notranslate"><span class="pre">seqStop</span></code></a>
shell command, that is, at this point all state sets should terminate (after
completing any action block in progress) and execution proceed with the
global exit block (if any). Afterwards all channels are disconnected, all
allocated memory is freed, and the program terminates.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the program has been started under an ioc shell, then only the SNL
program is terminated, not the whole ioc. If terminating the ioc
shell is required, you should call the <code class="docutils literal notranslate"><span class="pre">exit()</span></code> function from the
standard C library. This call can conveniently be placed in the SNL
program’s global exit block.</p>
</div>
</div>
</div>
<div class="section" id="block">
<h3>Block<a class="headerlink" href="#block" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-block">block      </strong> ::=  &quot;{&quot; <a class="reference internal" href="#grammar-token--92"><code class="xref docutils literal notranslate"><span class="pre">block_defns</span></code></a> <a class="reference internal" href="#grammar-token--94"><code class="xref docutils literal notranslate"><span class="pre">statements</span></code></a> &quot;}&quot;
<strong id="grammar-token-block_defns"><span id="grammar-token-block-defns"></span>block_defns</strong> ::=  <a class="reference internal" href="#grammar-token--92"><code class="xref docutils literal notranslate"><span class="pre">block_defns</span></code></a> <a class="reference internal" href="#grammar-token--93"><code class="xref docutils literal notranslate"><span class="pre">block_defn</span></code></a>
<strong id="grammar-token--92">block_defns</strong> ::= 
<strong id="grammar-token-block_defn"><span id="grammar-token-block-defn"></span>block_defn </strong> ::=  <a class="reference internal" href="#grammar-token--31"><code class="xref docutils literal notranslate"><span class="pre">declaration</span></code></a>
<strong id="grammar-token--93">block_defn </strong> ::=  <a class="reference internal" href="#grammar-token-c_code"><code class="xref docutils literal notranslate"><span class="pre">c_code</span></code></a>
</pre>
<p>Blocks are enclosed in matching (curly) braces. They may contain any
number of block definitions and afterwards any number of statements.</p>
<p>Block definitions are: declarations and embedded C code.</p>
</div>
</div>
<div class="section" id="statements-and-expressions">
<h2>Statements and Expressions<a class="headerlink" href="#statements-and-expressions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="statements">
<h3>Statements<a class="headerlink" href="#statements" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-statements">statements   </strong> ::=  <a class="reference internal" href="#grammar-token--94"><code class="xref docutils literal notranslate"><span class="pre">statements</span></code></a> <a class="reference internal" href="#grammar-token--104"><code class="xref docutils literal notranslate"><span class="pre">statement</span></code></a>
<strong id="grammar-token--94">statements   </strong> ::= 
<strong id="grammar-token-statement">statement    </strong> ::=  &quot;break&quot; &quot;;&quot;
<strong id="grammar-token--95">statement    </strong> ::=  &quot;continue&quot; &quot;;&quot;
<strong id="grammar-token--96">statement    </strong> ::=  <a class="reference internal" href="#grammar-token-c_code"><code class="xref docutils literal notranslate"><span class="pre">c_code</span></code></a>
<strong id="grammar-token--97">statement    </strong> ::=  <a class="reference internal" href="#grammar-token-block"><code class="xref docutils literal notranslate"><span class="pre">block</span></code></a>
<strong id="grammar-token--98">statement    </strong> ::=  &quot;if&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token--157"><code class="xref docutils literal notranslate"><span class="pre">comma_expr</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token--104"><code class="xref docutils literal notranslate"><span class="pre">statement</span></code></a>
<strong id="grammar-token--99">statement    </strong> ::=  &quot;if&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token--157"><code class="xref docutils literal notranslate"><span class="pre">comma_expr</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token--104"><code class="xref docutils literal notranslate"><span class="pre">statement</span></code></a> &quot;else&quot; <a class="reference internal" href="#grammar-token--104"><code class="xref docutils literal notranslate"><span class="pre">statement</span></code></a>
<strong id="grammar-token--100">statement    </strong> ::=  &quot;while&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token--157"><code class="xref docutils literal notranslate"><span class="pre">comma_expr</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token--104"><code class="xref docutils literal notranslate"><span class="pre">statement</span></code></a>
<strong id="grammar-token--101">statement    </strong> ::=  <a class="reference internal" href="#grammar-token-for_statement"><code class="xref docutils literal notranslate"><span class="pre">for_statement</span></code></a>
<strong id="grammar-token--102">statement    </strong> ::=  <a class="reference internal" href="#grammar-token--158"><code class="xref docutils literal notranslate"><span class="pre">opt_expr</span></code></a> &quot;;&quot;
<strong id="grammar-token-for_statement"><span id="grammar-token-for-statement"></span>for_statement</strong> ::=  &quot;for&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token--158"><code class="xref docutils literal notranslate"><span class="pre">opt_expr</span></code></a> &quot;;&quot; <a class="reference internal" href="#grammar-token--158"><code class="xref docutils literal notranslate"><span class="pre">opt_expr</span></code></a> &quot;;&quot; <a class="reference internal" href="#grammar-token--158"><code class="xref docutils literal notranslate"><span class="pre">opt_expr</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token--104"><code class="xref docutils literal notranslate"><span class="pre">statement</span></code></a>
</pre>
<p>As can be seen, most C statements are supported. Not supported is
the switch/case statement.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<pre>
<strong id="grammar-token--103">statement</strong> ::=  &quot;state&quot; <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a> &quot;;&quot;
</pre>
<p>The <em>state change statement</em> is not borrowed from C; it is only available
in the action block of a state <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> and has the effect
of immediately jumping out of the action block, overriding the statically
specified new state (given after the block) with its state argument.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<pre>
<strong id="grammar-token--104">statement</strong> ::=  &quot;return&quot; <a class="reference internal" href="#grammar-token--158"><code class="xref docutils literal notranslate"><span class="pre">opt_expr</span></code></a> &quot;;&quot;
</pre>
<p>The return statement can be used only inside <a class="reference internal" href="#function-definitions">Function Definitions</a>.</p>
</div>
<div class="section" id="expressions">
<h3>Expressions<a class="headerlink" href="#expressions" title="Permalink to this headline">¶</a></h3>
<p>Formation rules for expressions are listed in groups of descending order
of precedence. Precedence is determined by the standard C operator
precedence table.</p>
<div class="section" id="primary-expressions">
<h4>Primary Expressions<a class="headerlink" href="#primary-expressions" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-expr">expr  </strong> ::=  <a class="reference internal" href="#grammar-token-integer_literal"><code class="xref docutils literal notranslate"><span class="pre">integer_literal</span></code></a>
<strong id="grammar-token--105">expr  </strong> ::=  <a class="reference internal" href="#grammar-token-floating_point_literal"><code class="xref docutils literal notranslate"><span class="pre">floating_point_literal</span></code></a>
<strong id="grammar-token--106">expr  </strong> ::=  <a class="reference internal" href="#grammar-token-string"><code class="xref docutils literal notranslate"><span class="pre">string</span></code></a>
<strong id="grammar-token--107">expr  </strong> ::=  <a class="reference internal" href="#grammar-token-variable"><code class="xref docutils literal notranslate"><span class="pre">variable</span></code></a>
<strong id="grammar-token-string">string</strong> ::=  <a class="reference internal" href="#grammar-token-string_literal"><code class="xref docutils literal notranslate"><span class="pre">string_literal</span></code></a>
<strong id="grammar-token--108">expr  </strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token--157"><code class="xref docutils literal notranslate"><span class="pre">comma_expr</span></code></a> &quot;)&quot;
</pre>
<p>These are literals, variables, and parenthesized expressions.</p>
</div>
<div class="section" id="postfix-operators">
<h4>Postfix Operators<a class="headerlink" href="#postfix-operators" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token--109">expr  </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;(&quot; <a class="reference internal" href="#grammar-token--160"><code class="xref docutils literal notranslate"><span class="pre">args</span></code></a> &quot;)&quot;
<strong id="grammar-token--110">expr  </strong> ::=  &quot;exit&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token--160"><code class="xref docutils literal notranslate"><span class="pre">args</span></code></a> &quot;)&quot;
<strong id="grammar-token--111">expr  </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;[&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;]&quot;
<strong id="grammar-token--112">expr  </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;.&quot; <a class="reference internal" href="#grammar-token-member"><code class="xref docutils literal notranslate"><span class="pre">member</span></code></a>
<strong id="grammar-token--113">expr  </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;-&gt;&quot; <a class="reference internal" href="#grammar-token-member"><code class="xref docutils literal notranslate"><span class="pre">member</span></code></a>
<strong id="grammar-token--114">expr  </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;++&quot;
<strong id="grammar-token--115">expr  </strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;--&quot;
<strong id="grammar-token-member">member</strong> ::=  <a class="reference internal" href="#grammar-token-identifier"><code class="xref docutils literal notranslate"><span class="pre">identifier</span></code></a>
</pre>
<p>These are all left associative.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">exit</span></code> must be listed explicitly because in SNL it is a keyword,
not an identifier. The extra rule allows calls to the standard
library function <code class="docutils literal notranslate"><span class="pre">exit</span></code>.</p>
</div>
</div>
<div class="section" id="prefix-operators">
<h4>Prefix Operators<a class="headerlink" href="#prefix-operators" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token--116">expr</strong> ::=  &quot;+&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--117">expr</strong> ::=  &quot;-&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--118">expr</strong> ::=  &quot;*&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--119">expr</strong> ::=  &quot;&amp;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--120">expr</strong> ::=  &quot;!&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--121">expr</strong> ::=  &quot;~&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--122">expr</strong> ::=  &quot;++&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--123">expr</strong> ::=  &quot;--&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<p>Prefix operators are right-associative.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2: </span>Type casts and sizeof operator:</p>
</div>
<pre>
<strong id="grammar-token--124">expr</strong> ::=  &quot;(&quot; <a class="reference internal" href="#grammar-token--55"><code class="xref docutils literal notranslate"><span class="pre">type_expr</span></code></a> &quot;)&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--125">expr</strong> ::=  &quot;sizeof&quot; &quot;(&quot; <a class="reference internal" href="#grammar-token--55"><code class="xref docutils literal notranslate"><span class="pre">type_expr</span></code></a> &quot;)&quot;
<strong id="grammar-token--126">expr</strong> ::=  &quot;sizeof&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
</div>
<div class="section" id="binary-operators">
<h4>Binary Operators<a class="headerlink" href="#binary-operators" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token--127">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;-&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--128">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;+&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--129">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&lt;&lt;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--130">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&gt;&gt;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--131">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;*&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--132">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;/&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--133">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&gt;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--134">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&gt;=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--135">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&lt;=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--136">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&lt;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--137">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;==&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--138">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;!=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--139">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&amp;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--140">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;^&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--141">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;|&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--142">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;||&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--143">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&amp;&amp;&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<pre>
<strong id="grammar-token--144">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;%&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<p>All binary operators associate to the left.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Like in most programming languages, including C, evaluation of
conditional expressions using <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">||</span></code> is done <em>lazily</em>: the
second operand is not evaluated if evaluation of the first already
determines the result. This particularly applies to the boolean
expressions in <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clauses. See the built-in function
<a class="reference internal" href="#c.pvGetQ" title="pvGetQ"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetQ</span></code></a> for an extended discussion.</p>
</div>
</div>
<div class="section" id="ternary-operator">
<h4>Ternary Operator<a class="headerlink" href="#ternary-operator" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token--145">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;?&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;:&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<p>The ternary operator (there is only one) is right-associative.</p>
</div>
<div class="section" id="assignment-operators">
<span id="id7"></span><h4>Assignment Operators<a class="headerlink" href="#assignment-operators" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token--146">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--147">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;+=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--148">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;-=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--149">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&amp;=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--150">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;|=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--151">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;/=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--152">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;*=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--153">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;%=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--154">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&lt;&lt;=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--155">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;&gt;&gt;=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--156">expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a> &quot;^=&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
</pre>
<p>These operators are right-associative.</p>
</div>
<div class="section" id="comma-operator">
<h4>Comma Operator<a class="headerlink" href="#comma-operator" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-comma_expr"><span id="grammar-token-comma-expr"></span>comma_expr</strong> ::=  <a class="reference internal" href="#grammar-token--157"><code class="xref docutils literal notranslate"><span class="pre">comma_expr</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--157">comma_expr</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token-opt_expr"><span id="grammar-token-opt-expr"></span>opt_expr  </strong> ::=  <a class="reference internal" href="#grammar-token--157"><code class="xref docutils literal notranslate"><span class="pre">comma_expr</span></code></a>
<strong id="grammar-token--158">opt_expr  </strong> ::= 
</pre>
<p>The comma operator is left associative. An <a class="reference internal" href="#grammar-token--158"><code class="xref any std std-token docutils literal notranslate"><span class="pre">opt_expr</span></code></a> is
an optional <a class="reference internal" href="#grammar-token--157"><code class="xref any std std-token docutils literal notranslate"><span class="pre">comma_expr</span></code></a>; it appears, for instance, inside
a <a class="reference internal" href="#grammar-token-for_statement"><code class="xref any std std-token docutils literal notranslate"><span class="pre">for_statement</span></code></a>.</p>
</div>
<div class="section" id="argument-list">
<h4>Argument List<a class="headerlink" href="#argument-list" title="Permalink to this headline">¶</a></h4>
<pre>
<strong id="grammar-token-args">args</strong> ::=  <a class="reference internal" href="#grammar-token--160"><code class="xref docutils literal notranslate"><span class="pre">args</span></code></a> &quot;,&quot; <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--159">args</strong> ::=  <a class="reference internal" href="#grammar-token--156"><code class="xref docutils literal notranslate"><span class="pre">expr</span></code></a>
<strong id="grammar-token--160">args</strong> ::= 
</pre>
<p>Function argument lists look exactly like chained application of the
comma operator, which is why application of the comma operator in an
argument list must be grouped by parentheses.</p>
</div>
</div>
</div>
<div class="section" id="built-in-constants">
<h2>Built-in Constants<a class="headerlink" href="#built-in-constants" title="Permalink to this headline">¶</a></h2>
<p>Some of the built-in functions use (i.e. accept or return) values of
certain enumeration types and constants. These are also available to C
code and defined in the header files pvAlarm.h and seqCom.h.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1.6.</span></p>
</div>
<p>The pvStat and pvSevr constants are now known to the compiler, so you
no longer have to declare them as <code class="docutils literal notranslate"><span class="pre">foreign</span></code> in the SNL code.</p>
<dl class="c type">
<dt id="c.pvStat">
<em class="property">type </em><code class="sig-name descname">pvStat</code><a class="headerlink" href="#c.pvStat" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>An enumeration for status values.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>typedef enum {
    /* generic OK and error statuses */
    pvStatOK           = 0,
    pvStatERROR        = -1,
    pvStatDISCONN      = -2,

    /* correspond to EPICS statuses */
    pvStatREAD         = 1,
    pvStatWRITE        = 2,
    pvStatHIHI         = 3,
    pvStatHIGH         = 4,
    pvStatLOLO         = 5,
    pvStatLOW          = 6,
    pvStatSTATE        = 7,
    pvStatCOS          = 8,
    pvStatCOMM         = 9,
    pvStatTIMEOUT      = 10,
    pvStatHW_LIMIT     = 11,
    pvStatCALC         = 12,
    pvStatSCAN         = 13,
    pvStatLINK         = 14,
    pvStatSOFT         = 15,
    pvStatBAD_SUB      = 16,
    pvStatUDF          = 17,
    pvStatDISABLE      = 18,
    pvStatSIMM         = 19,
    pvStatREAD_ACCESS  = 20,
    pvStatWRITE_ACCESS = 21
} pvStat;
</pre></div>
</div>
<dl class="c type">
<dt id="c.pvSevr">
<em class="property">type </em><code class="sig-name descname">pvSevr</code><a class="headerlink" href="#c.pvSevr" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>typedef enum {
    /* generic OK and error severities */
    pvSevrOK      = 0,
    pvSevrERROR   = -1,

    /* correspond to EPICS severities */
    pvSevrNONE    = 0,
    pvSevrMINOR   = 1,
    pvSevrMAJOR   = 2,
    pvSevrINVALID = 3
} pvSevr;
</pre></div>
</div>
<dl class="c type">
<dt id="c.compType">
<em class="property">type </em><code class="sig-name descname">compType</code><a class="headerlink" href="#c.compType" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>enum compType {
    DEFAULT,
    ASYNC,
    SYNC
};
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">SYNC</span></code></a> and <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">ASYNC</span></code></a> are SNL built-in constants
(i.e. known to <a class="reference internal" href="Glossary.html#term-snc"><code class="xref any std std-term docutils literal notranslate"><span class="pre">snc</span></code></a>). The constant <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">DEFAULT</span></code></a> is for use in C
code (to represent a missing optional argument).</p>
</div>
<dl class="c type">
<dt id="c.seqBool">
<em class="property">type </em><code class="sig-name descname">seqBool</code><a class="headerlink" href="#c.seqBool" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>typedef int seqBool;

#define TRUE   1
#define FALSE  0
</pre></div>
</div>
<dl class="c macro">
<dt id="c.NOEVFLAG">
<code class="sig-name descname">NOEVFLAG</code><a class="headerlink" href="#c.NOEVFLAG" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define NOEVFLAG 0
</pre></div>
</div>
<p>This can be given as second argument to <a class="reference internal" href="#c.pvSync" title="pvSync"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvSync</span></code></a> (instead of
an event flag) to cancel the sync.</p>
</div>
<div class="section" id="built-in-functions">
<span id="builtinfunctions"></span><h2>Built-in Functions<a class="headerlink" href="#built-in-functions" title="Permalink to this headline">¶</a></h2>
<p>The following special functions are built into the language. In most cases
the compiler performs some special interpretation of the arguments to these
functions. Using their C equivalents in escaped C code is possible but
subject to special rules.</p>
<p>For documentation purposes only, we assign special pseudo-types to some of
the parameters of built-in functions. Note that these are not valid SNL types.</p>
<dl class="c type">
<dt id="c.channel">
<em class="property">type </em><code class="sig-name descname">channel</code><a class="headerlink" href="#c.channel" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>A parameter with this type means the function expects an SNL variable or
array element that is assigned to a single (possibly anonymous) process
variable.</p>
<p>A parameter with type <code class="docutils literal notranslate"><span class="pre">channel[]</span></code> means the function expects a channel
array, that is, an array where the elements are assigned to separate
(possibly anonymous) process variables. By convention, functions accepting a
<a class="reference internal" href="#c.channel" title="channel"><code class="xref any c c-type docutils literal notranslate"><span class="pre">channel</span></code></a> array have a name that starts with “pvArray”.</p>
<p>Several of these functions are intended to be called only from
<a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clauses or only from action code. If the compiler allows
it, it is safe to call them in another context, but the effect might not be
what you expect.</p>
<div class="section" id="delay">
<h3>delay<a class="headerlink" href="#delay" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.delay">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">delay</code><span class="sig-paren">(</span>double <em>delay_in_seconds</em><span class="sig-paren">)</span><a class="headerlink" href="#c.delay" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the specified time has elapsed since entering the
state. It should be used only within a <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> expression.</p>
<p>The “t” <a class="reference internal" href="#stateoption"><span class="std std-ref">State Option</span></a> controls whether the
delay is measured from when the current state was entered from a different
state (<a class="reference internal" href="#id3"><span class="std std-ref">-t</span></a>) or from any state, including itself (<a class="reference internal" href="#state-option-t"><span class="std std-ref">+t</span></a>,
the default).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>It is no longer allowed to call this function outside the <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a> of a
<a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clause.</p>
</div>
<div class="section" id="pvput">
<h3>pvPut<a class="headerlink" href="#pvput" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvPut">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvPut</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>, <a class="reference internal" href="#c.compType" title="compType">compType</a> <em>mode</em> = DEFAULT, double <em>timeout</em> = 10.0<span class="sig-paren">)</span><a class="headerlink" href="#c.pvPut" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Puts (or writes) the value of <code class="docutils literal notranslate"><span class="pre">ch</span></code> to the process variable it has been
assigned to. Returns the status from the PV layer (e.g. <a class="reference internal" href="#c.pvStat" title="pvStat"><code class="xref any c c-type docutils literal notranslate"><span class="pre">pvStatOK</span></code></a>
for success).</p>
<p>By default, i.e. with no optional arguments, <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> is un-confirmed “fire
and forget”; completion must be inferred by other means. An optional second
argument can change this default:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">SYNC</span></code></a> causes it to block the state set until completion. This
mode is called <em>synchronous</em>.</p></li>
<li><p><a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">ASYNC</span></code></a> allows the state set to continue but still check for
completion via a subsequent call to <a class="reference internal" href="#c.pvPutComplete" title="pvPutComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPutComplete</span></code></a> (typically in a
<a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>). This mode is called <em>asnchronous</em>.</p></li>
</ul>
<p>A timeout value may be specified after the <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">SYNC</span></code></a> argument. This
should be a positive floating point number, specifying the number of seconds
before the request times out. This value overrides the default timeout of 10
seconds.</p>
<p>Note that SNL allows only one pending <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> per variable and state set
to be active. As long as a <code class="docutils literal notranslate"><span class="pre">pvPut(var,ASYNC)</span></code> is pending completion,
further calls to <code class="docutils literal notranslate"><span class="pre">pvPut(var,ASYNC)</span></code> from the same state set immediately
fail and an error message is printed; whereas further calls to <code class="docutils literal notranslate"><span class="pre">pvPut(var,SYNC)</span></code>
are <em>delayed</em> until the previous operation completes. Thus</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pvPut(var,ASYNC);
pvPut(var,SYNC);
</pre></div>
</div>
<p>and</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pvPut(var,SYNC);
pvPut(var,SYNC);
</pre></div>
</div>
<p>are equivalent. Whereas in</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pvPut(var,ASYNC);
pvPut(var,ASYNC);
</pre></div>
</div>
<p>the second pvPut may fail if it is a named PV located on another IOC (since
the first one is still awaiting completion), whereas for local named PVs and
anonymous PVs it will succeed (since completion is immediate in these cases).</p>
<p>In <a class="reference internal" href="#safe-mode"><span class="std std-ref">Safe Mode</span></a>, <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> can be used with anonymous PVs (variables assigned
to “”) to communicate between state sets. This makes sense only with global
variables as only those can be referenced in more than one state set. The
behaviour for anonymous PVs exactly mirrors that of named PVs, including the fact
that the new value will not be seen by other state sets until they issue a pvGet,
or, if the variable is monitored, until they wait for an event in a <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>.
Note that for anonymous PVs completion is always immediate, so the <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">ASYNC</span></code></a> option
is not very useful.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvputcomplete">
<h3>pvPutComplete<a class="headerlink" href="#pvputcomplete" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvPutComplete">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvPutComplete</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvPutComplete" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the last asynchronous <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> to this process variable has
completed.</p>
<p>Always returns <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> for anonymous PVs.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error. In previous versions this was the one built-in pv
function that correctly worked on channel arrays. The corresponding C
function still has the extra arguments for compatibility, but in SNL code
you must now use <a class="reference internal" href="#c.pvArrayPutComplete" title="pvArrayPutComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvArrayPutComplete</span></code></a> for channel arrays.</p>
</div>
<div class="section" id="pvarrayputcomplete">
<h3>pvArrayPutComplete<a class="headerlink" href="#pvarrayputcomplete" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayPutComplete">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvArrayPutComplete</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em>, <a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <em>any</em> = FALSE, <a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> *<em>complete</em> = NULL<span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayPutComplete" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Like <a class="reference internal" href="#c.pvPutComplete" title="pvPutComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPutComplete</span></code></a>, but returns whether all of the <code class="docutils literal notranslate"><span class="pre">length</span></code> first
elements of the array have completed their last asynchronous <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a>. The
<code class="docutils literal notranslate"><span class="pre">length</span></code> argument should not be larger than the number of elements in
the array.</p>
<p>If the optional <code class="docutils literal notranslate"><span class="pre">any</span></code> argument is <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>, then instead it returns whether
<em>any</em> of these channels have completed.</p>
<p>If the optional <code class="docutils literal notranslate"><span class="pre">complete</span></code> argument is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, it must point to an
array of <a class="reference internal" href="#c.seqBool" title="seqBool"><code class="xref any c c-type docutils literal notranslate"><span class="pre">seqBool</span></code></a>s with at least  <code class="docutils literal notranslate"><span class="pre">length</span></code> elements; the will then
write the individual results for the array elements into this array.</p>
</div>
<div class="section" id="pvputcancel">
<h3>pvPutCancel<a class="headerlink" href="#pvputcancel" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvPutCancel">
void <code class="sig-name descname">pvPutCancel</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvPutCancel" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Cancel a pending (asynchronous) <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a>.</p>
</div>
<div class="section" id="pvarrayputcancel">
<h3>pvArrayPutCancel<a class="headerlink" href="#pvarrayputcancel" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayPutCancel">
void <code class="sig-name descname">pvArrayPutCancel</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayPutCancel" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Like <a class="reference internal" href="#c.pvPutCancel" title="pvPutCancel"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPutCancel</span></code></a> but all pending asynchronous <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a>s to the first
<code class="docutils literal notranslate"><span class="pre">length</span></code> elements of the array are cancelled.</p>
</div>
<div class="section" id="pvget">
<h3>pvGet<a class="headerlink" href="#pvget" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvGet">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvGet</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>, <a class="reference internal" href="#c.compType" title="compType">compType</a> <em>ct</em> = DEFAULT, double <em>timeout</em> = 10.0<span class="sig-paren">)</span><a class="headerlink" href="#c.pvGet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Gets (or reads) the value of <code class="docutils literal notranslate"><span class="pre">ch</span></code> from the process variable it has been
assigned to. Returns the status from the PV layer (e.g. <a class="reference internal" href="#c.pvStat" title="pvStat"><code class="xref any c c-type docutils literal notranslate"><span class="pre">pvStatOK</span></code></a>
for success).</p>
<p>With no optional arguments, the completion type is determined by the value
of a program option: if <a class="reference internal" href="Compiling.html#cmdoption-a"><code class="xref any std std-option docutils literal notranslate"><span class="pre">-a</span></code></a> is in effect (the default), then the state set
will block until the read operation is complete or until the default timeout
of 10 seconds has expired; if <a class="reference internal" href="Compiling.html#cmdoption-arg-a"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+a</span></code></a> is in effect, the the call completes
immediately and completion can be checked with subsequent calls to
<a class="reference internal" href="#c.pvGetComplete" title="pvGetComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetComplete</span></code></a> (typically in a <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>).</p>
<p>An optional second argument overrides the program option: <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">SYNC</span></code></a>
makes the call block and <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">ASYNC</span></code></a> makes the call return
immediately, regardless of whether <a class="reference internal" href="Compiling.html#cmdoption-a"><code class="xref any std std-option docutils literal notranslate"><span class="pre">-a</span></code></a> or <a class="reference internal" href="Compiling.html#cmdoption-arg-a"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+a</span></code></a> is in effect.</p>
<p>In <a class="reference internal" href="#safe-mode"><span class="std std-ref">Safe Mode</span></a>, if <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">ASYNC</span></code></a> is specified and the variable is not
monitored, then the state set local copy of the variable will not be updated
until a call to pvGetComplete is made and returns <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> or, if the
variable is monitored, until the state set waits for events in a <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a>
clause. Note that anonymous PVs behave exactly in the same way.</p>
<p>Like for <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a>, only one pending <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> per channel and state set can be
active.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>A timeout value may be specified after the <a class="reference internal" href="#c.compType" title="compType"><code class="xref any c c-type docutils literal notranslate"><span class="pre">SYNC</span></code></a> argument. This should be
a positive floating point number, specifying the number of seconds before
the request times out. This value overrides the default timeout of 10 seconds.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvgetcomplete">
<h3>pvGetComplete<a class="headerlink" href="#pvgetcomplete" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvGetComplete">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvGetComplete</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvGetComplete" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the last asynchronous <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> for <code class="docutils literal notranslate"><span class="pre">ch</span></code> has completed.</p>
<p>In <a class="reference internal" href="#safe-mode"><span class="std std-ref">Safe Mode</span></a>, the the state set local copy of the variable will be
updated with the value from the PV layer as a side effect of this call
(if <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> is returned).</p>
<p>Always returns <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> for anonymous PVs.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error. For use with multi-PV arrays there is now
<a class="reference internal" href="#c.pvArrayGetComplete" title="pvArrayGetComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvArrayGetComplete</span></code></a>.</p>
</div>
<div class="section" id="pvarraygetcomplete">
<h3>pvArrayGetComplete<a class="headerlink" href="#pvarraygetcomplete" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayGetComplete">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvArrayGetComplete</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em>, <a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <em>any</em> = FALSE, <a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> *<em>complete</em> = NULL<span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayGetComplete" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Like <a class="reference internal" href="#c.pvGetComplete" title="pvGetComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetComplete</span></code></a> but works on all channels of a multi-PV array. The
optional arguments have the same meaning as for <a class="reference internal" href="#c.pvArrayPutComplete" title="pvArrayPutComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvArrayPutComplete</span></code></a>.</p>
</div>
<div class="section" id="pvgetcancel">
<h3>pvGetCancel<a class="headerlink" href="#pvgetcancel" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvGetCancel">
void <code class="sig-name descname">pvGetCancel</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvGetCancel" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Cancel a pending (asynchronous) <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a>.</p>
</div>
<div class="section" id="pvarraygetcancel">
<h3>pvArrayGetCancel<a class="headerlink" href="#pvarraygetcancel" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayGetCancel">
void <code class="sig-name descname">pvArrayGetCancel</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayGetCancel" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Cancel pending (asynchronous) <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> operations for the first <code class="docutils literal notranslate"><span class="pre">length</span></code>
elements of the array.</p>
</div>
<div class="section" id="pvgetq">
<h3>pvGetQ<a class="headerlink" href="#pvgetq" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvGetQ">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvGetQ</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvGetQ" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>The channel argument must have been associated with a queue using the
<a class="reference internal" href="#grammar-token--74"><code class="xref any std std-token docutils literal notranslate"><span class="pre">syncq</span></code></a> clause.</p>
<p>If the queue is not empty, remove its first (oldest) value and update the
variable with it. Returns whether there was an element in the queue (and the
variable got updated). If an element gets removed, and the queue becomes
empty as a result, then any event flag <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a>ed to the variable will be
cleared.</p>
<p>Note that since pvGetQ may have a <em>side-effect</em> you should be careful when
combining a call to pvGetQ with other <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>s in the same
<a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clause, e.g.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>when (pvGetQ(msg) &amp;&amp; other_condition) {
   printf(msg);
} state ...
</pre></div>
</div>
<p>would remove the head from the queue every time the <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a> gets
evaluated, regardless of whether <code class="docutils literal notranslate"><span class="pre">other_condition</span></code> is <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>. This is
most probably not the desired effect, as you would lose an unknown number of
messages. (Of course it <em>could</em> be exactly what you want, for instance if
<code class="docutils literal notranslate"><span class="pre">other_condition</span></code> were something like <code class="docutils literal notranslate"><span class="pre">!suppress_output</span></code>.) Whereas</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>when (other_condition &amp;&amp; pvGetQ(msg)) {
   printf(msg);
} state ...
</pre></div>
</div>
<p>is “safe”, in the sense that no messages will be lost. BTW, If you combine
with a disjunction (“||”) it is the other way around, i.e. pvGetQ should
appear as the first operand. This is all merely a result of the evaluation
order imposed by the C language (and thus by SNL); similar remarks apply
whenever you want to use an expression inside a <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clause
that potentially has a side-effect.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvfreeq">
<h3>pvFreeQ<a class="headerlink" href="#pvfreeq" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvFreeQ">
void <code class="sig-name descname">pvFreeQ</code><span class="sig-paren">(</span>queued_channel<span class="sig-paren">)</span><a class="headerlink" href="#c.pvFreeQ" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Deletes all entries from a queued variable’s queue and
clears the associated event flag.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1.</span></p>
</div>
<p>Queue elements are no longer dynamically allocated, so this
is now an alias for pvFlushQ.</p>
</div>
<div class="section" id="pvflushq">
<h3>pvFlushQ<a class="headerlink" href="#pvflushq" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvFlushQ">
void <code class="sig-name descname">pvFlushQ</code><span class="sig-paren">(</span>queued_channel<span class="sig-paren">)</span><a class="headerlink" href="#c.pvFlushQ" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>Flush the queue associated with this variable, so it is empty afterwards.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvassign">
<h3>pvAssign<a class="headerlink" href="#pvassign" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvAssign">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvAssign</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>, char *<em>pv_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvAssign" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Assigns or re-assigns <code class="docutils literal notranslate"><span class="pre">ch</span></code> to a process variable with name <code class="docutils literal notranslate"><span class="pre">pv_name</span></code>. If
<code class="docutils literal notranslate"><span class="pre">pv_name</span></code> is an empty string or <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, then <code class="docutils literal notranslate"><span class="pre">ch</span></code> is de-assigned (not
associated with any process variable); in <a class="reference internal" href="#safe-mode"><span class="std std-ref">Safe Mode</span></a> it causes assignment
to an anonymous PV.</p>
<p>See also <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> clause.</p>
<p>Note that pvAsssign is <em>asynchronous</em>: it sends a request to search for and
connect to the given <code class="docutils literal notranslate"><span class="pre">pv_name</span></code>, but it does not wait for a
response, similar to <code class="docutils literal notranslate"><span class="pre">pvGet(var,ASYNC)</span></code>. Calling pvAssign <em>does</em> have one
immediate effect, namely de-assigning the variable from any PV it currently
is assigned to. In order to make sure that it has connected to the new PV,
you can use the <a class="reference internal" href="#c.pvConnected" title="pvConnected"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvConnected</span></code></a> built-in function inside a <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a>
clause.</p>
<p>Like for all other operations, completion is immediate for anonymous PVs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>pvAssign can only be called on variables (or array elements)
that have been statically marked as process variables using the
<a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> syntax. An empty string may be used for the initial
assignment, or (from version 2.1. onward) the simplified form
<code class="docutils literal notranslate"><span class="pre">assign</span> <span class="pre">var</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a variable gets de-assigned from a non-empty to an empty
name, the corresponding channel is destroyed, which means that
dynamically allocated memory gets freed. If your
system cannot handle dynamic memory allocation without fragmentation,
care should be taken that assignment and de-assignment do not
alternate too often.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to assign array elements to separate PVs, you cannot
currently do this with a single call (in contrast to doing it in an
<a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> clause. Instead, you must call <code class="docutils literal notranslate"><span class="pre">pvAssign</span></code>
for each array element individually.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvassignsubst">
<h3>pvAssignSubst<a class="headerlink" href="#pvassignsubst" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvAssignSubst">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvAssignSubst</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>, char *<em>pv_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvAssignSubst" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Like <a class="reference internal" href="#c.pvAssign" title="pvAssign"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvAssign</span></code></a>, except that it substitutes program parameters, like the
<a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> clause.</p>
</div>
<div class="section" id="pvmonitor">
<h3>pvMonitor<a class="headerlink" href="#pvmonitor" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvMonitor">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvMonitor</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvMonitor" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Initiates a monitor on the process variable that <code class="docutils literal notranslate"><span class="pre">ch</span></code> was assigned to.</p>
<p>See <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a> clause.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvarraymonitor">
<h3>pvArrayMonitor<a class="headerlink" href="#pvarraymonitor" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayMonitor">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvArrayMonitor</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayMonitor" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Like <a class="reference internal" href="#c.pvMonitor" title="pvMonitor"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvMonitor</span></code></a> but turns on monitors for the first <code class="docutils literal notranslate"><span class="pre">length</span></code> elements of
a channel array.</p>
<p>See <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a> clause.</p>
</div>
<div class="section" id="pvstopmonitor">
<h3>pvStopMonitor<a class="headerlink" href="#pvstopmonitor" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvStopMonitor">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvStopMonitor</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvStopMonitor" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Terminates a monitor on the underlying process variable.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvarraystopmonitor">
<h3>pvArrayStopMonitor<a class="headerlink" href="#pvarraystopmonitor" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayStopMonitor">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvArrayStopMonitor</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayStopMonitor" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Like <a class="reference internal" href="#c.pvStopMonitor" title="pvStopMonitor"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvStopMonitor</span></code></a> but turns off monitors for the first <code class="docutils literal notranslate"><span class="pre">length</span></code>
elements of a channel array.</p>
</div>
<div class="section" id="pvsync">
<h3>pvSync<a class="headerlink" href="#pvsync" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvSync">
void <code class="sig-name descname">pvSync</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>, evflag <em>ef</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvSync" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Synchronizes a variable with an event flag, or removes such a
synchronization if <code class="docutils literal notranslate"><span class="pre">ef</span></code> is <a class="reference internal" href="#c.NOEVFLAG" title="NOEVFLAG"><code class="xref any c c-macro docutils literal notranslate"><span class="pre">NOEVFLAG</span></code></a>.</p>
<p>See <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a> clause.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvarraysync">
<h3>pvArraySync<a class="headerlink" href="#pvarraysync" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArraySync">
void <code class="sig-name descname">pvArraySync</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em>, evflag <em>ef</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvArraySync" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Synchronizes the first <code class="docutils literal notranslate"><span class="pre">length</span></code> elements of a channel array with an event
flag, or removes such a synchronization if <code class="docutils literal notranslate"><span class="pre">ef</span></code> is <a class="reference internal" href="#c.NOEVFLAG" title="NOEVFLAG"><code class="xref any c c-macro docutils literal notranslate"><span class="pre">NOEVFLAG</span></code></a>.</p>
<p>See <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a> clause.</p>
</div>
<div class="section" id="pvcount">
<h3>pvCount<a class="headerlink" href="#pvcount" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvCount">
unsigned <code class="sig-name descname">pvCount</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvCount" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the element count associated with the (single) process variable.
This value is independent of the array size given in the declaration, it can
be smaller or larger.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvstatus">
<h3>pvStatus<a class="headerlink" href="#pvstatus" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvStatus">
<a class="reference internal" href="#c.pvStat" title="pvStat">pvStat</a> <code class="sig-name descname">pvStatus</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvStatus" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the current alarm status of the underlying PV or indicates failure
of a previous PV operation.</p>
<p>The status, severity, and message returned by <a class="reference internal" href="#c.pvStatus" title="pvStatus"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvStatus</span></code></a>,
<a class="reference internal" href="#c.pvSeverity" title="pvSeverity"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvSeverity</span></code></a>, and <a class="reference internal" href="#c.pvMessage" title="pvMessage"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvMessage</span></code></a> reflect either the underlying
PV’s properties (if a <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> or <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> operation completed, or the variable is
<a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a>ed), or else indicate a failure to initiate one of these operations.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvseverity">
<h3>pvSeverity<a class="headerlink" href="#pvseverity" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvSeverity">
<a class="reference internal" href="#c.pvSevr" title="pvSevr">pvSevr</a> <code class="sig-name descname">pvSeverity</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvSeverity" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the current alarm severity (e.g. pvSevrMAJOR) of the underlying PV
or indicates failure of a previous PV operation.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvmessage">
<h3>pvMessage<a class="headerlink" href="#pvmessage" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvMessage">
<em class="property">const</em> char *<code class="sig-name descname">pvMessage</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvMessage" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the current error message of the variable, or “” (the empty string)
if none is available.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvtimestamp">
<h3>pvTimeStamp<a class="headerlink" href="#pvtimestamp" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvTimeStamp">
<em class="property">struct</em> epicsTimeStamp <code class="sig-name descname">pvTimeStamp</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvTimeStamp" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the time stamp for the last <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> completion or monitor
event for this variable.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<p>You can declare variables of type <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">epicsTimeStamp</span></code> directly in SNL
code.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvassigned">
<h3>pvAssigned<a class="headerlink" href="#pvassigned" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvAssigned">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvAssigned</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvAssigned" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the SNL variable is currently assigned to a process variable.
Note that this function returns <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> for anonymous PVs.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvconnected">
<h3>pvConnected<a class="headerlink" href="#pvconnected" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvConnected">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvConnected</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvConnected" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the underlying process variable is currently connected.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Always returns <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> for anonymous PVs.</p>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvarrayconnected">
<h3>pvArrayConnected<a class="headerlink" href="#pvarrayconnected" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<dl class="c function">
<dt id="c.pvArrayConnected">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">pvArrayConnected</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em>[], unsigned int <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvArrayConnected" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether elements of a channel array are currently connected.</p>
</div>
<div class="section" id="pvindex">
<h3>pvIndex<a class="headerlink" href="#pvindex" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvIndex">
unsigned <code class="sig-name descname">pvIndex</code><span class="sig-paren">(</span><a class="reference internal" href="#c.channel" title="channel">channel</a> <em>ch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pvIndex" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the index associated with a variable. See
<a class="reference internal" href="EscapeToC.html#calling-pv-functions-from-c"><span class="std std-ref">Calling PV Functions from C</span></a> for how to use this function.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>Calling this function with a multi-PV array is no longer allowed and results
in a compile-time error.</p>
</div>
<div class="section" id="pvflush">
<h3>pvFlush<a class="headerlink" href="#pvflush" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvFlush">
void <code class="sig-name descname">pvFlush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.pvFlush" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Causes the PV layer to flush its send buffer. This is only
necessary if you need to make sure that CA operations are
started <em>before</em> the action block finishes. The buffer is
always automatically flushed before the sequencer waits
for events, that is, after a state’s entry block is executed
(or on entry to the state if there is no entry block).
The buffer is also flushed after initiating a synchronous
operation that waits for a callback (i.e. <code class="docutils literal notranslate"><span class="pre">pvPut(var,SYNC)</span></code>
and <code class="docutils literal notranslate"><span class="pre">pvGet(var,SYNC)</span></code>).</p>
</div>
<div class="section" id="pvchannelcount">
<h3>pvChannelCount<a class="headerlink" href="#pvchannelcount" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvChannelCount">
unsigned <code class="sig-name descname">pvChannelCount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.pvChannelCount" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the total number of process variables
associated with the program.</p>
</div>
<div class="section" id="pvassigncount">
<h3>pvAssignCount<a class="headerlink" href="#pvassigncount" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvAssignCount">
unsigned <code class="sig-name descname">pvAssignCount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.pvAssignCount" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the total number of SNL variables in this
program that are assigned to underlying process variables.</p>
<p>For instance, if all SNL variables are assigned then the following
expression is <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pvAssignCount() == pvChannelCount()
</pre></div>
</div>
<p>Each element of an SNL array counts as variable for the purposes of
<a class="reference internal" href="#c.pvAssignCount" title="pvAssignCount"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvAssignCount</span></code></a>.</p>
</div>
<div class="section" id="pvconnectcount">
<h3>pvConnectCount<a class="headerlink" href="#pvconnectcount" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.pvConnectCount">
unsigned <code class="sig-name descname">pvConnectCount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.pvConnectCount" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns the total number of underlying process
variables that are connected.</p>
<p>For instance, if all assigned variables are connected then the following
expression is <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pvConnectCount() == pvAssignCount()
</pre></div>
</div>
</div>
<div class="section" id="efset">
<h3>efSet<a class="headerlink" href="#efset" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.efSet">
void <code class="sig-name descname">efSet</code><span class="sig-paren">(</span>evflag <em>ef</em><span class="sig-paren">)</span><a class="headerlink" href="#c.efSet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Sets the event flag and causes evaluation of the <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a>
clauses for all state sets that are pending on this event flag.</p>
</div>
<div class="section" id="efclear">
<h3>efClear<a class="headerlink" href="#efclear" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.efClear">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">efClear</code><span class="sig-paren">(</span>evflag <em>ef</em><span class="sig-paren">)</span><a class="headerlink" href="#c.efClear" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Clears the event flag and causes evaluation of the <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a>
clauses for all state sets that are pending on this event flag.</p>
</div>
<div class="section" id="eftest">
<h3>efTest<a class="headerlink" href="#eftest" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.efTest">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">efTest</code><span class="sig-paren">(</span>evflag <em>ef</em><span class="sig-paren">)</span><a class="headerlink" href="#c.efTest" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the event flag was set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In safe mode, this function is a synchronization point for all
variables (channels) that are <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a>ed with it, i.e. the
state set local copy of these variables will be updated from their
current globally visible value.</p>
</div>
</div>
<div class="section" id="eftestandclear">
<h3>efTestAndClear<a class="headerlink" href="#eftestandclear" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.efTestAndClear">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">efTestAndClear</code><span class="sig-paren">(</span>evflag <em>ef</em><span class="sig-paren">)</span><a class="headerlink" href="#c.efTestAndClear" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Clears the event flag and returns whether the event
flag was set. It is intended for use within a <a class="reference internal" href="#grammar-token--91"><code class="xref any std std-token docutils literal notranslate"><span class="pre">transition</span></code></a> clause.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In safe mode, this function is a synchronization point for all
variables (channels) that are <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a>ed with it, i.e. the
state set local copy of these variables will be updated from their
current globally visible value.</p>
</div>
</div>
<div class="section" id="macvalueget">
<h3>macValueGet<a class="headerlink" href="#macvalueget" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.macValueGet">
char *<code class="sig-name descname">macValueGet</code><span class="sig-paren">(</span>char *<em>parameter_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.macValueGet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns a pointer to the value of the specified program parameter, if
it exists, else <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. See <a class="reference internal" href="#program-name-and-parameters">Program Name and Parameters</a>.</p>
</div>
<div class="section" id="optget">
<h3>optGet<a class="headerlink" href="#optget" title="Permalink to this headline">¶</a></h3>
<dl class="c function">
<dt id="c.optGet">
<a class="reference internal" href="#c.seqBool" title="seqBool">seqBool</a> <code class="sig-name descname">optGet</code><span class="sig-paren">(</span>char *<em>option_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.optGet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>Returns whether the program option with the given name is in effect or not.
The option name is a string consisting of a single letter such as “a” for
the program option <a class="reference internal" href="Compiling.html#cmdoption-arg-a"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+a</span></code></a>/<a class="reference internal" href="Compiling.html#cmdoption-a"><code class="xref any std std-option docutils literal notranslate"><span class="pre">-a</span></code></a>.</p>
</div>
</div>
<div class="section" id="safe-mode">
<span id="id11"></span><h2>Safe Mode<a class="headerlink" href="#safe-mode" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
<p>SNL code can be interpreted in safe mode by using the program option <a class="reference internal" href="Compiling.html#cmdoption-arg-s"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+s</span></code></a>,
see <a class="reference internal" href="Tutorial.html#safe-mode-tutorial"><span class="std std-ref">Safe Mode</span></a> for a less dense introduction. Safe mode implies
reentrant mode, see <a class="reference internal" href="EscapeToC.html#reentrant-option"><span class="std std-ref">Variable Modification for Reentrant Option</span></a>.</p>
<p>In safe mode, global variables are treated as if they were local to the
state set. Changing such a variable inside an action block does not have any
immediate effect on other state sets, nor do external events, such as
monitors or pvGet completions, change the variables as seen by a state set,
except at well defined <a class="reference internal" href="#synchronization-points"><span class="std std-ref">Synchronization Points</span></a>. In other words, each state
set works on its own copy (“view”) of all variables. The <code class="xref any docutils literal notranslate"><span class="pre">Channel</span> <span class="pre">Access</span></code>
layer (and the part of the run time system that implements <a class="reference internal" href="#anonymous-channels"><span class="std std-ref">Anonymous Channels</span></a>) acts on yet another copy, the “world view”. Information is only
ever exchanged between the world view and the state set local view. All
communication between state sets must be explicit: apart from using event
flags, the only way information can flow <em>out</em> of a state set is using
<a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a>, the only way <em>in</em> is via <a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> or monitors.</p>
<p>An important (and welcome) side-effect of safe mode is that in the action
block after a condition you can rely on the <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a> to be <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> (and
remain <a class="reference internal" href="Glossary.html#term-true"><code class="xref any std std-term docutils literal notranslate"><span class="pre">true</span></code></a> – unless, of course, the action block itself invalidates it
by modifying the variables involved).</p>
<div class="section" id="synchronization-points">
<span id="id12"></span><h3>Synchronization Points<a class="headerlink" href="#synchronization-points" title="Permalink to this headline">¶</a></h3>
<p>At certain points in the program a state set’s view of the variables is
updated from the world view. These are:</p>
<ul class="simple">
<li><p>in each state, immediately before <a class="reference internal" href="#grammar-token-condition"><code class="xref any std std-token docutils literal notranslate"><span class="pre">condition</span></code></a>s are evaluated (for
monitored channels), and</p></li>
<li><p>in calls to some of the built-in functions: <a class="reference internal" href="#c.efTest" title="efTest"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTest</span></code></a>, <a class="reference internal" href="#c.efTestAndClear" title="efTestAndClear"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTestAndClear</span></code></a>,
<a class="reference internal" href="#c.pvGet" title="pvGet"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGet</span></code></a> (in SYNC mode), and <a class="reference internal" href="#c.pvGetComplete" title="pvGetComplete"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvGetComplete</span></code></a> (when it signals completion).</p></li>
</ul>
<p>Note that there is no point at which variables modified by a state set are
automatically “published”. For this you have to use <a class="reference internal" href="#c.pvPut" title="pvPut"><code class="xref any c c-func docutils literal notranslate"><span class="pre">pvPut</span></code></a> explicitly,
which updates the world view as a side-effect.</p>
</div>
<div class="section" id="anonymous-pvs">
<span id="anonymous-channels"></span><span id="id13"></span><h3>Anonymous Channels<a class="headerlink" href="#anonymous-pvs" title="Permalink to this headline">¶</a></h3>
<p>It would be impractical if the programmer had to create a real PV for each
communication channel inside a program. Instead, in safe mode you can use an
<em>anonymous channel</em> for this purpose. Anonymous channels are created with
the usual <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> clause, but use an empty string (<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>) for the PV name
(which in traditional mode is interpreted as “not assigned”). You can
imagine such channels to be connected to “virtual” PVs that are implemented
inside the sequencer’s run time system.</p>
<p>Anonymous channels should work exactly like channels assigned to a “real” PV
– they can be <a class="reference internal" href="#grammar-token-monitor"><code class="xref any std std-token docutils literal notranslate"><span class="pre">monitor</span></code></a>ed, <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a>ed to event flags etc. – except that
they are always connected and the operations on them always complete
immediately.</p>
</div>
<div class="section" id="event-flags-in-safe-mode">
<h3>Event Flags in Safe Mode<a class="headerlink" href="#event-flags-in-safe-mode" title="Permalink to this headline">¶</a></h3>
<p>Apart from the <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a> and <a class="reference internal" href="#grammar-token--74"><code class="xref any std std-token docutils literal notranslate"><span class="pre">syncq</span></code></a> features, and apart from the atomicity of
<a class="reference internal" href="#c.efTestAndClear" title="efTestAndClear"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTestAndClear</span></code></a>, an event flag behaves like an anonymous PV of boolean type
with a monitor. In safe mode, <a class="reference internal" href="#c.efTest" title="efTest"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTest</span></code></a> and <a class="reference internal" href="#c.efTestAndClear" title="efTestAndClear"><code class="xref any c c-func docutils literal notranslate"><span class="pre">efTestAndClear</span></code></a> have the
additional side-effect of acting as a synchronization point for all
variables that are <a class="reference internal" href="#grammar-token-sync"><code class="xref any std std-token docutils literal notranslate"><span class="pre">sync</span></code></a>ed with the event flag.</p>
</div>
</div>
<div class="section" id="foreign-variables-and-functions">
<h2>Foreign Variables and Functions<a class="headerlink" href="#foreign-variables-and-functions" title="Permalink to this headline">¶</a></h2>
<p>You can use (reference, call) any exported C variable or function that is
linked to your program. For instance, you may link a C library to the SNL
program and simply call functions from it directly in SNL code. We call such
entities or objects “foreign”.</p>
<p>It is advisable to take care that the C code generated from your SNL program
contains (directly or via <code class="docutils literal notranslate"><span class="pre">#include</span></code>) a valid declaration for foreign
entities, otherwise the C compiler will not be able to catch type errors
(the SNL compiler does not do any type-checking by itself). For libraries,
this is usually done by adding a line</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%%#include &quot;api-of-your-library.h&quot;
</pre></div>
</div>
<p>(See also <a class="reference internal" href="EscapeToC.html#preprocessor-directives"><span class="std std-ref">Preprocessor Directives</span></a>.)</p>
<p>Note that when passing channel variables (i.e. ones assigned to one or more
PVs using an <a class="reference internal" href="#grammar-token--69"><code class="xref any std std-token docutils literal notranslate"><span class="pre">assign</span></code></a> clause) to a C function, only the <em>value</em> is
passed. The special assigned” status of the variable gets lost as soon as
the function is entered (same as for functions defined in SNL).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.</span></p>
</div>
<p>The SNL compiler no longer complains about “undeclared identifiers” when
using foreign variables unless you supply the <a class="reference internal" href="Compiling.html#cmdoption-arg-W"><code class="xref any std std-option docutils literal notranslate"><span class="pre">+W</span></code></a> (extra warnings)
option.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3><a href="Manual.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">SNL Reference for Version 2.2</a><ul>
<li><a class="reference internal" href="#lexical-syntax">Lexical Syntax</a><ul>
<li><a class="reference internal" href="#comments">Comments</a></li>
<li><a class="reference internal" href="#identifiers">Identifiers</a></li>
<li><a class="reference internal" href="#literals">Literals</a></li>
<li><a class="reference internal" href="#embedded-c-code">Embedded C Code</a></li>
<li><a class="reference internal" href="#line-markers">Line Markers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#program">Program</a><ul>
<li><a class="reference internal" href="#program-name-and-parameters">Program Name and Parameters</a></li>
<li><a class="reference internal" href="#global-entry-and-exit-blocks">Global Entry and Exit Blocks</a></li>
<li><a class="reference internal" href="#final-c-code-block">Final C Code Block</a></li>
</ul>
</li>
<li><a class="reference internal" href="#definitions">Definitions</a><ul>
<li><a class="reference internal" href="#function-definitions">Function Definitions</a></li>
<li><a class="reference internal" href="#type-definitions">Type Definitions</a></li>
<li><a class="reference internal" href="#variable-declarations">Variable Declarations</a><ul>
<li><a class="reference internal" href="#const">const</a></li>
<li><a class="reference internal" href="#foreign-declarations">Foreign Declarations</a></li>
<li><a class="reference internal" href="#basic-types">Basic Types</a></li>
<li><a class="reference internal" href="#type-expressions">Type Expressions</a></li>
<li><a class="reference internal" href="#strings">Strings</a></li>
<li><a class="reference internal" href="#event-flags">Event Flags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#variable-scope-and-life-time">Variable Scope and Life Time</a></li>
<li><a class="reference internal" href="#variable-initialization">Variable Initialization</a></li>
<li><a class="reference internal" href="#process-variables">Process Variables</a><ul>
<li><a class="reference internal" href="#assign">assign</a></li>
<li><a class="reference internal" href="#monitor">monitor</a></li>
<li><a class="reference internal" href="#sync">sync</a></li>
<li><a class="reference internal" href="#syncq">syncQ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#option">Option</a></li>
</ul>
</li>
<li><a class="reference internal" href="#state-set">State Set</a><ul>
<li><a class="reference internal" href="#state-set-local-definition">State Set Local Definition</a></li>
<li><a class="reference internal" href="#state">State</a><ul>
<li><a class="reference internal" href="#state-local-definition">State Local Definition</a></li>
<li><a class="reference internal" href="#state-option">State Option</a></li>
<li><a class="reference internal" href="#state-entry-and-exit-blocks">State Entry and Exit Blocks</a></li>
<li><a class="reference internal" href="#transitions">Transitions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#block">Block</a></li>
</ul>
</li>
<li><a class="reference internal" href="#statements-and-expressions">Statements and Expressions</a><ul>
<li><a class="reference internal" href="#statements">Statements</a></li>
<li><a class="reference internal" href="#expressions">Expressions</a><ul>
<li><a class="reference internal" href="#primary-expressions">Primary Expressions</a></li>
<li><a class="reference internal" href="#postfix-operators">Postfix Operators</a></li>
<li><a class="reference internal" href="#prefix-operators">Prefix Operators</a></li>
<li><a class="reference internal" href="#binary-operators">Binary Operators</a></li>
<li><a class="reference internal" href="#ternary-operator">Ternary Operator</a></li>
<li><a class="reference internal" href="#assignment-operators">Assignment Operators</a></li>
<li><a class="reference internal" href="#comma-operator">Comma Operator</a></li>
<li><a class="reference internal" href="#argument-list">Argument List</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#built-in-constants">Built-in Constants</a></li>
<li><a class="reference internal" href="#built-in-functions">Built-in Functions</a><ul>
<li><a class="reference internal" href="#delay">delay</a></li>
<li><a class="reference internal" href="#pvput">pvPut</a></li>
<li><a class="reference internal" href="#pvputcomplete">pvPutComplete</a></li>
<li><a class="reference internal" href="#pvarrayputcomplete">pvArrayPutComplete</a></li>
<li><a class="reference internal" href="#pvputcancel">pvPutCancel</a></li>
<li><a class="reference internal" href="#pvarrayputcancel">pvArrayPutCancel</a></li>
<li><a class="reference internal" href="#pvget">pvGet</a></li>
<li><a class="reference internal" href="#pvgetcomplete">pvGetComplete</a></li>
<li><a class="reference internal" href="#pvarraygetcomplete">pvArrayGetComplete</a></li>
<li><a class="reference internal" href="#pvgetcancel">pvGetCancel</a></li>
<li><a class="reference internal" href="#pvarraygetcancel">pvArrayGetCancel</a></li>
<li><a class="reference internal" href="#pvgetq">pvGetQ</a></li>
<li><a class="reference internal" href="#pvfreeq">pvFreeQ</a></li>
<li><a class="reference internal" href="#pvflushq">pvFlushQ</a></li>
<li><a class="reference internal" href="#pvassign">pvAssign</a></li>
<li><a class="reference internal" href="#pvassignsubst">pvAssignSubst</a></li>
<li><a class="reference internal" href="#pvmonitor">pvMonitor</a></li>
<li><a class="reference internal" href="#pvarraymonitor">pvArrayMonitor</a></li>
<li><a class="reference internal" href="#pvstopmonitor">pvStopMonitor</a></li>
<li><a class="reference internal" href="#pvarraystopmonitor">pvArrayStopMonitor</a></li>
<li><a class="reference internal" href="#pvsync">pvSync</a></li>
<li><a class="reference internal" href="#pvarraysync">pvArraySync</a></li>
<li><a class="reference internal" href="#pvcount">pvCount</a></li>
<li><a class="reference internal" href="#pvstatus">pvStatus</a></li>
<li><a class="reference internal" href="#pvseverity">pvSeverity</a></li>
<li><a class="reference internal" href="#pvmessage">pvMessage</a></li>
<li><a class="reference internal" href="#pvtimestamp">pvTimeStamp</a></li>
<li><a class="reference internal" href="#pvassigned">pvAssigned</a></li>
<li><a class="reference internal" href="#pvconnected">pvConnected</a></li>
<li><a class="reference internal" href="#pvarrayconnected">pvArrayConnected</a></li>
<li><a class="reference internal" href="#pvindex">pvIndex</a></li>
<li><a class="reference internal" href="#pvflush">pvFlush</a></li>
<li><a class="reference internal" href="#pvchannelcount">pvChannelCount</a></li>
<li><a class="reference internal" href="#pvassigncount">pvAssignCount</a></li>
<li><a class="reference internal" href="#pvconnectcount">pvConnectCount</a></li>
<li><a class="reference internal" href="#efset">efSet</a></li>
<li><a class="reference internal" href="#efclear">efClear</a></li>
<li><a class="reference internal" href="#eftest">efTest</a></li>
<li><a class="reference internal" href="#eftestandclear">efTestAndClear</a></li>
<li><a class="reference internal" href="#macvalueget">macValueGet</a></li>
<li><a class="reference internal" href="#optget">optGet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#safe-mode">Safe Mode</a><ul>
<li><a class="reference internal" href="#synchronization-points">Synchronization Points</a></li>
<li><a class="reference internal" href="#anonymous-pvs">Anonymous Channels</a></li>
<li><a class="reference internal" href="#event-flags-in-safe-mode">Event Flags in Safe Mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#foreign-variables-and-functions">Foreign Variables and Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="EscapeToC.html"
                        title="previous chapter">Escape to C Code</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Examples.html"
                        title="next chapter">Examples of SNL Programs</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>